<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>Vue3 | 知瑾</title><meta name="keywords" content="vue3"><meta name="author" content="知瑾"><meta name="copyright" content="知瑾"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="Vue3"><meta name="application-name" content="Vue3"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="Vue3"><meta property="og:url" content="http://example.com/2022/05/28/Vue3%E5%88%B7%E6%96%87%E6%A1%A3/index.html"><meta property="og:site_name" content="知瑾"><meta property="og:description" content="关于 Vue3Vue两个核心? 声明式渲染：Vue基于标准HTML拓展了一套模板语法，声明式地描述基于JavaScript和Html状态之间的关系。 响应式：Vue 会自动跟踪 JavaScript 状态并在其发生变化时响应式地更新 DOM。  什么是渐进式框架官网：Vue 的设计非常注重灵活性和”"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://s2.loli.net/2022/02/02/QxIWdTG2rFOaRSv.png"><meta property="article:author" content="知瑾"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://s2.loli.net/2022/02/02/QxIWdTG2rFOaRSv.png"><meta name="description" content="关于 Vue3Vue两个核心? 声明式渲染：Vue基于标准HTML拓展了一套模板语法，声明式地描述基于JavaScript和Html状态之间的关系。 响应式：Vue 会自动跟踪 JavaScript 状态并在其发生变化时响应式地更新 DOM。  什么是渐进式框架官网：Vue 的设计非常注重灵活性和”"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/2022/05/28/Vue3%E5%88%B7%E6%96%87%E6%A1%A3/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://cdn.jsdelivr.net/gh/berniezhong/picture-bed/github/202406031028986.png"},
  postHeadAiDescription: undefined,
  diytitle: undefined,
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:{"enable":true,"maxBarrage":1,"barrageTime":4000,"accessToken":"","mailMd5":""},
  root: '/',
  preloader: {"source":2},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    simplehomepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-right"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isAnchor: true,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '知瑾',
  title: 'Vue3',
  postAI: '',
  pageFillDescription: '关于 Vue3, Vue两个核心?, 单文件组件？, 选项式和组合式的特点？, vite 创建项目命令：, vite 中使用 less, 创建 vue 应用：, 应用实例, 挂载应用, 应用配置, 挂载多个应用, 响应式基础, 声明响应式状态, DOM 更新时机, 深层响应性, 响应式代理 vs 原始对象, 计算属性, 基础使用：, 可修改的计算属性, 计算属性缓存 vs 方法, 计算属性使用注意点：, 侦听器, 基础侦听, 深层侦听, watchEffect, 回调的刷新时机, 取消监听, 类与样式的绑定, 条件渲染, 列表渲染, 事件绑定, 基础修饰符：, 按键修饰符：, 生命周期, 依赖注入, 内置组件, Transtion, 为过渡命名, 自定义过渡 class, 出现时过渡, 组件间过渡, 监听过渡事件, TransitionGroup, KeepAlive, Teleport, Suspense, async setup（）, 加载中状态, 内置组件结合使用：, 模板 ref, 组件基础, 组件定义, 组件传值, props 的校验, emit 传值校验, modelValue的使用, update：modelValue, 组件插槽, 透传 Attribute, 属性继承, 事件继承, 禁用 Attribute, 多节点继承, 在 JS 中访问透传属性, 动态组件, 全局注册组件, 局部注册组件, 异步组件, ES 模块动态导入, 可复用性, 组合式函数 Hook, 自定义指令, 插件关于两个核心声明式渲染基于标准拓展了一套模板语法声明式地描述基于和状态之间的关系响应式会自动跟踪状态并在其发生变化时响应式地更新什么是渐进式框架官网的设计非常注重灵活性和可以被逐步集成这个特点根据你的需求场景你可以用不同的方式使用理解除了遵守特定语法之外不需要考虑其他职责之外的事你可以只用我的一部分而不需要了解我职责之外的事情拿对比你使用之前还必须要知道什么是副作用什么是纯函数等等单文件组件类似格式的文件来书写组件它被称为单文件组件也被称为文件的单文件组件会将一个组件的逻辑封装在同一个文件里选项式和组合式的特点选项式组合式选项式用多个选项的对象来描述组件的逻辑例如选项所定义的属性都会暴露在函数内部的上最终都指向当前的组件实例选项式以组件实例的概念为中心它将响应性相关的细节抽象出来并强制按照选择来组织代码组合式的核心思想是直接在函数作用域内定义响应式状态变量并将多个函数中得到的状态组合起来处理复杂的问题这种形式更加自由灵活性和重用逻辑模式更加强大创建项目命令中使用安装命令在中引入全局的样式创建应用应用实例每个都通过函数创建一个应用实例从一个单文件组件中导入根组件挂载应用应用实例必须在调用了后才会被渲染出来方法接受一个容器接收的参数可以是一个实际的元素或是一个选择器字符串方法应始终在整个应用配置和资源注册完成后才被调用返回值是挂载组件的实例而不是非应用实例应用配置应用实例会暴露一个对象它允许我们配置一些应用级的选项例如全局的错误捕捉注册全局组件等应用配置必须在挂载应用实例之前完成挂载多个应用应用实例并不只限于一个可以创建多个共存的应用通过挂载多个应用来实现每个应用都有自己的全局配置和全局资源作用域比如和是两个应用响应式基础声明响应式状态官方推荐使用来声明响应式状态获取值为默认值被传递给函数或者从一般对象上被解构时不会丢失响应式需要通过取值不会丢失响应式为什么使用会追踪在渲染过程中使用的每一个当某个被修改时都会触发追踪它的组件的一次重新渲染内部是通过和方法来拦截对象属性的和操作属性允许检测何时被访问或修改通过来追踪通过来执行触发另一个好处是与普通变量不同允许被传递给函数同时保留对最新值和响应式的连接的访问有利于复杂逻辑的复用使用函数创建一个响应式对象或者数组特点仅对对象类型有效对象数组等集合类型而对基础类型这样的无效响应式对象不支持解构要保持响应式对象的相同引用不可以随意替换一个响应式对象如下以下行为将丢失响应性更新时机修改一个响应式状态时也会被自动更新但是更新并不是同步的是因为要确保无论更新多少次响应式数据组件只会更新一次如果要等待更新完成后再执行额外的代码可以使用访问更新后的另外一种写法更新后再执行的代码深层响应性深层响应性浅层响应性中默认是深层响应式的在更改深层对象和数组时也是能被检测到的所以是响应式的使用可以实现只有根级别的数据是响应的是响应式的不是响应式的不会被转为响应式响应式代理原始对象通过创建的响应式对象是原始对象的代理对象它和原始对象不相等代理和原始对象不是全等的只有代理对象是响应的更改原始对象不会触发更新所以仅使用声明对象的代理版本对同一个对象调用总是返回同样的代理而对已存在代理调用也是返回同样的代理在同一个对象上调用会返回相同的代理在一个代理上调用会返回他自己以上规则同样适用于嵌套对象计算属性基础使用计算属性通过函数返回一个对象读取值的时候使用在模版中使用不需要解包直接使用函数名在中使用需要可修改的计算属性当尝试修改一个计算属性时可以通过和来创建通过某个按钮修改计算属性的值中会变成计算属性缓存方法计算属性普通方法计算属性值会基于其响应式依赖被缓存一个计算属性仅会在其响应式依赖更新时才重新计算也就是说只要依赖不改变无论多少次访问都会返回先前的计算结果而不会重复执行函数以下意味着计算属性永远不会更新因为并不是一个响应式依赖它没有依赖任何其他是一个固定值方法总是在每次渲染时都会再次执行模板中也使用方法直接调用来获取对应的依赖结果计算属性使用注意点计算函数不应该有副作用不要在计算函数中做异步请求或者更改避免直接修改计算属性值计算属性返回值是只读的更新计算值应该由它所依赖的源状态触发侦听器监听某个属性每次响应式状态发生变化时触发回调函数基础侦听的第一个参数可以是包括计算属性响应式对象一个函数或者多个来源组成的数组单个函数多个来源组成的数组注意不能侦听响应式对象的属性例如这不起作用因为你向传入了一个正确的使用方式提供一个函数提供一个函数深层侦听和相等引用类型同一个对象不同于函数只有函数的更新才会触发将函数侦听隐式转换深层侦听在创建侦听器时会立即执行一遍回调正常监听立即获取再侦听变化改成上面的例子中会先执行一次回调自动追踪相当于计算属性每当变化会再次触发回调不同之处只追踪明确的侦听源不追踪回调内访问的属性在副作用发生时追踪依赖只有在响应源改变时才会触发回调自动追踪所有能访问到的响应式属性更好的控制回调的触发时机代码简洁但其响应依赖关系不明确回调的刷新时机默认情况侦听器内访问是更新之前的若想在回调中访问更新后的可以添加属性的回调刷新别名而不需要在更新后执行取消监听当该侦听器不再需要时需要异步创建侦听器的情况很少请尽可能选择同步创建如果需要等待一些异步数据你可以使用条件式的侦听逻辑需要异步请求得到的数据数据加载后执行某些操作类与样式的绑定绑定绑定内联样式绑定对象两个类和的显示取决于布尔值和可以通过计算属性来绑定转换后绑定数组使用三元判断使用真假动态添加组件绑定普通绑定组件内动态绑定若想组件内某个元素接收这个可以通过组件的来实现模板使用时最终渲染成普通绑定绑定对象绑定数组条件渲染指令是真实的按条件渲染是一种懒加载的渲染若初次渲染为则不会做任何事直到条件改变为的时候才会渲染元素无论初始条件为真假始终存在于中优化频繁切换使用运行时不经常改变用和不同时使用和不能同时使用因为的优先级比较高执行的时候会先执行而增加内存消耗列表渲染循环数组循环对象可以在上使用小程序的也是一样有时候希望展示经过过滤或排序后的内容可以使用已过滤或已排序数组的计算属性事件绑定基础修饰符单击事件将停止传递提交事件将不再重新加载页面修饰语可以使用链式书写也可以只有修饰符仅当是元素本身时才会触发事件处理器例如事件处理器不来自子元素在事件后同步更新而不是用户输入自动转换为数字默认自动去除用户输入内容中两端的空格按键修饰符仅在为时调用生命周期生命周期描述在组件挂载完成后执行包含了所有同步组件的加载树创建并挂载到父容器中不包含异步组件在组件因为响应式状态变更而更新其树之后调用如果需特定的状态改变后才调用使用在组件实例被卸载之后调用清除定时器取消监听销毁在组件被挂载之前被调用当这个钩子被调用时组件已经完成了其响应式状态的设置但还没有创建节点它即将首次执行渲染过程在组件即将因为响应式状态变更而更新其树之前调用在组件实例被卸载之前调用在捕获了后代组件传递的错误时调用当响应式依赖被组件的渲染作用追踪后调用这个钩子仅在开发模式下可用且在服务器端渲染期间不会被调用当响应式依赖触发了组件渲染作用的运行之后调用这个钩子仅在开发模式下可用且在服务器端渲染期间不会被调用若组件实例是缓存树的一部分当组件被插入到中时调用若组件实例是缓存树的一部分当组件从中被移除时调用依赖注入提供一个值供后代组件使用与注册生命周期钩子的类似必须在组件的阶段同步调用为组件后代供给数据一个组件可以多次调用使用不同的注入名注入不同的依赖值参数一参数二静态值响应式的值若不使用确保是在同步调用的注入名值应用层注入名值应用级的供给在应用的所有组件中都可以注入编写插件时会特别有用因为插件一般都不会使用组件形式来供给值只读若想确保从祖先传递的值不被组件更改你可以使用来包装提供的值注入供给的值注入值的默认方式注入响应式的值通过类型的注入注入一个值若为空则使用提供的默认值注入一个值若为空则使用提供的工厂函数注入时为了表明提供的默认值是个函数需要传入第三个参数内置组件内置组件无需注册可以直接在模板中使用只有使用时才会包含在构建中仅支持为单个元素或组件提供动画过度效果如果内容是一个组件这个组件必须仅有一个根元素动画的触发条件是由由由特殊元素切换的动态组件为过渡命名通过一个声明一种过渡对于已命名的过渡它的过渡相关会以其名字而不是作为前缀比如上方的例子相关会是而不是这个的应该是自定义过渡可以使用第三方库出现时过渡想要初次渲染就有过渡动画添加属性组件间过渡监听过渡事件为列表中的多个元素或组件提供过渡效果缓存包裹在其中的动态切换组件包裹动态组件时会缓存不活跃的组件实例而不是销毁它们当一个组件在中被切换时它的和生命周期钩子将被调用用来替代和这适用于的直接子节点及其所有子孙节点基本用法与一起使用使用用逗号分隔的字符串正则表达式使用数组使用将插槽内容渲染到的另一个部分指定目标容器有条件的禁用用于在组件树中编排嵌套的异步依赖项假设组件树中有多个嵌套组件要渲染出它们首先得解析一些异步资源它们每个都需要处理自己的加载报错和完成状态在最坏的情况下我们可能会在页面上看到三个旋转的加载态在不同的时间显示出内容有了之后就可以在等待整个多层级组件树中的各个异步依赖获取结果时才展示出加载中或加载失败的状态可以等待的异步依赖有两种带有异步钩子的组件这也包含了使用时有顶层表达式的组件异步组件在组合式中的可以是异步的语法糖中顶层表达式会自动让该组件成为一个异步依赖加载中状态接受两个插槽和它将在内存中渲染默认插槽的同时展示后备插槽内容如果在渲染时遇到异步依赖项异步组件和具有的组件它会等所有异步依赖项解析完成时再显示默认插槽示例具有深层异步依赖的组件在插槽中显示正在加载中在默认组件中具有深层异步依赖的组件所以组件将会在秒后才进行渲染内置组件结合使用要保证这些组件都能正常使用嵌套顺序非常重要主要内容加载中状态正在加载模板模板函数组件上的需要操作元素的时候给元素绑定在中绑定需要先声明一个同名的声明一个来存放该元素的引用必须和模板同名除了给绑定字符串之外还可以绑定一个函数在每次组件更新时函数都被调用函数接受该元素引用作为第一个参数将分配给或当被应用到组件上时将引用的是组件实例是组件的实例此时父组件可以通过访问子组件中的任何属性和方法有一种特殊情况如果子组件使用语法糖父组件将访问不到子组件的属性和方法可以通过宏函数暴露子组件的属性和方法让父组件能完全访问到子组件中父组件中都会自动解包和一般的实例一样组件基础组件定义单文件组件不用语法糖文件方式方式组件传值若使用语法糖在子组件中需要通过定义可接受的的属性并且声明的会自动暴露给模板会返回一个对象的参数和父组件提供的的值是相同的语法不使用语法糖接收字符串形式接收对象形式传递多个时的可以使用父组件等价于循环组件可以使用的形式等价于数据单向流所有都遵循单向绑定原则因父组件的更新而变化自然会将新的状态向下传递是不可逆的子组件修改父组件在子组件中新定义一个局部属性从中获取初始值以原始的形式传入使用计算属性转换自定义事件通过定义自定义事件名子组件定义发射事件父组件对象会作为函数的第一个参数接收字符串形式接收对象形式自定义事件通过自定义发射事件的校验基础类型检查多种可能的类型必传默认值对象类型所有接收到的参数自定义类型函数传入的必须符合以下表达式传值校验自定义事件传值也可以做校验验证是否通过的使用等价于在父组件中等价于在组件中这么使用以上为了子组件能正常运行在中使用和父组件提供的默认是形式在子组件中多个绑定组件插槽元素是一个插槽的插口标示了父元素提供的插槽内容将在哪里被渲染渲染作用域默认内容具名插槽动态插槽名作用域插槽具名作用域插槽父组件中都是父组件中的渲染内容内容一样但是插槽内容无法访问子组件内容任何父组件模板中的东西都只被编译到父组件的作用域中而任何子组件模板中的东西都只被编译到子组件的作用域中默认内容默认内容给提供一个属性用来给各个插槽分配唯一的没有提供属性的插槽隐式的命名为父组件插入内容时要提供一个的指令给元素的缩写是插槽的内容放这里缩写为有些场景需要在插槽内使用父组件及子组件内的数据要做到这一点可以通过渲染插槽时将一部分数据提供给插槽子组件内的模板当需要接收时默认插槽和具名插槽使用方式有区别父组件内的插槽接收也可以使用解构父组件访问不同的具名插槽的数据通过具名作用域插槽实现子组件中默认值父组件中透传属性继承父组件传递子组件的或者事件是透传属性但是像这种属性没有显式的在子组件中声明子组件也会继承来自父组件的属性父组件中子组件中当子组件已经有属性会自动合并父组件中子组件中事件继承父组件中监听器会添加到的根元素上当根元素的事件触发后也会触发父组件中的方法如果子组件中同样有绑定事件两个事件都会被触发禁用禁止属性的继承在组件选项中设置若是使用语法糖需要额外一个部分逻辑最常见的需要禁用继承的场景就是需要应用在根节点以外的其他元素上你可以完全控制透传进来的如何应用几个注意点像这样的属性需要通过来访问像这样事件监听器将在此对象下被暴露为一个函数举个例子假设父组件传递过来的只应用到上而不是外层的上多节点继承有多个节点的子组件没有自动属性的透传行为如果没有被显示绑定将会抛出警告子组件内部是这样的因为不知道透传到哪一个节点如果有显式绑定则不会有警告在中访问透传属性在语法糖中可以使用来访问一个组件所有的透传属性不使用语法糖中将在上下文对象中透传被暴露为最为重要的一点透传的并不是响应式的可以通过来解决响应的问题使用使得在每次更新时结合最新的执行副作用动态组件当多个组件来回切换的时候可以使用动态组件的属性实现的值被注册的组件名导入的组件对象假设现在有两个组件分别是当上面的例子为时就会渲染组件相反当为时就会渲染组件组件切换后会自动卸载可以通过组件强制不活跃的子组件仍然保持状态全局注册组件组件名组件链式全局注册局部注册组件若使用语法糖导入的组件可以在本地直接使用无需注册若不使用语法糖需要在中注册异步组件组件的按需引入即仅在需要时才从服务器加载相关组件使用获取到的组件方法接收一个返回的加载函数的回调方法应该在服务器获得组件定义时调用也可以用表明加载失败模块动态导入使用模块动态导入也会返回可以和联合使用是一个包装器组件仅在页面需要它时才调用加载函数可以使用异步的包装器组件实现延迟加载可复用性组合式函数封装公共任务的逻辑使它变成一个可复用的函数这个格式化封装了无状态的逻辑它在接收到一些值后立刻返回所期望的输出其实就是函数下面是简单的鼠标位置的按照惯例组合式函数名以开头被组合式函数封装和管理的状态组合式函数可以随时更改其状态一个组合式函数也可以挂靠在所属组件的生命周期上来启动和卸载副作用通过返回值暴露所管理的状态在组件使用的时候自定义指令一个自定义指令被定义为一个包含类似于组件的生命周期钩子的对象在语法糖中任何以开头的驼峰命名都可以被用作一个自定义指令在模板中启用上面自动聚焦指令可以在页面完成加载后运行也可以在动态插入元素后运行全局注册指令指令钩子在绑定元素的前或事件监听器应用前调用下面会介绍各个参数的细节在元素被插入到前调用在绑定元素的父组件及他自己的所有子节点都挂载完成后调用绑定元素的父组件更新前调用在绑定元素的父组件及他自己的所有子节点都更新后调用绑定元素的父组件卸载前调用绑定元素的父组件卸载后调用钩子参数指令绑定到元素可以直接操作一个对象包含传递给指令的值例如在中值是旧值仅在和中可用传给指令的参数中参数是一个包含修饰符的对象中修饰符对象是使用该指令的组件实例指令的定义对象代表绑定元素的底层参数会是这样一个对象的值上一次更新时的值简化形式对象字面量如果指令需要多个值可以向它传递一个对象字面量也可以接收表达式插件插件是一种能为添加全局功能的工具代码安装一个插件可选的选项插件是拥有方法的对象是一个安装函数函数接收应用实例和的额外选项使用场景通过和注册的组件和指令通过使一个资源可供给全局向中添加一些全局实例属性和方法编写插件插件中的和国际化插件在一个单独的文件创建并导出它在上编写一个翻译文本的函数函数接收一个值在字段中查找对应的值得到翻译内容注入一个全局可用的方法获取对象的深层属性使用作为索引这个插件希望用户在使用该插件时通过传入一个对象会接收一个的字符串在用户提供的字典中查找并返回翻译的值在插件中可以通过来为插件用户提供一些内容我们可以将参数提供给整个应用以便整个组件都可以使用翻译字典对象插件用户就可以在他们的组件中以为注入并访问插件的选项对象了',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-06-03 17:41:16',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.1.1"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">React</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://berniezwd.github.io/REACT_MARQUEE/" title="跑马灯"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/default_cover.jpg&quot;" data-lazy-src="/img/project/marquee.png" alt="跑马灯"/><span class="back-menu-item-text">跑马灯</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">有趣</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://berniezwd.github.io/PeopleJS/" title="人潮汹涌"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/default_cover.jpg&quot;" data-lazy-src="/img/project/people.png" alt="人潮汹涌"/><span class="back-menu-item-text">人潮汹涌</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">知瑾</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 即刻短文</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/default_cover.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/default_cover.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Docker/" style="font-size: 1.05rem; color: rgb(137, 101, 96);">Docker<sup>3</sup></a><a href="/tags/Html/" style="font-size: 1.05rem; color: rgb(184, 54, 188);">Html<sup>1</sup></a><a href="/tags/JavaScript/" style="font-size: 1.05rem; color: rgb(183, 195, 91);">JavaScript<sup>3</sup></a><a href="/tags/Jenkins%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/" style="font-size: 1.05rem; color: rgb(116, 32, 129);">Jenkins自动化部署<sup>1</sup></a><a href="/tags/Nginx/" style="font-size: 1.05rem; color: rgb(9, 56, 35);">Nginx<sup>1</sup></a><a href="/tags/Pinia/" style="font-size: 1.05rem; color: rgb(196, 73, 61);">Pinia<sup>1</sup></a><a href="/tags/React/" style="font-size: 1.05rem; color: rgb(168, 187, 161); font-weight: 500; color: var(--anzhiyu-lighttext)">React<sup>4</sup></a><a href="/tags/Redux/" style="font-size: 1.05rem; color: rgb(136, 129, 120);">Redux<sup>1</sup></a><a href="/tags/TypeScript/" style="font-size: 1.05rem; color: rgb(82, 91, 72); font-weight: 500; color: var(--anzhiyu-lighttext)">TypeScript<sup>1</sup></a><a href="/tags/Vue/" style="font-size: 1.05rem; color: rgb(146, 29, 187);">Vue<sup>2</sup></a><a href="/tags/axios/" style="font-size: 1.05rem; color: rgb(77, 197, 45);">axios<sup>1</sup></a><a href="/tags/centOS/" style="font-size: 1.05rem; color: rgb(104, 60, 179);">centOS<sup>1</sup></a><a href="/tags/css/" style="font-size: 1.05rem; color: rgb(35, 80, 192);">css<sup>2</sup></a><a href="/tags/electron/" style="font-size: 1.05rem; color: rgb(76, 85, 32);">electron<sup>2</sup></a><a href="/tags/koa/" style="font-size: 1.05rem; color: rgb(58, 109, 14);">koa<sup>1</sup></a><a href="/tags/mysql/" style="font-size: 1.05rem; color: rgb(129, 142, 14);">mysql<sup>1</sup></a><a href="/tags/nestjs/" style="font-size: 1.05rem; color: rgb(91, 75, 194);">nestjs<sup>1</sup></a><a href="/tags/node/" style="font-size: 1.05rem; color: rgb(177, 122, 188);">node<sup>1</sup></a><a href="/tags/sass/" style="font-size: 1.05rem; color: rgb(16, 87, 68);">sass<sup>1</sup></a><a href="/tags/uniapp/" style="font-size: 1.05rem; color: rgb(98, 90, 153); font-weight: 500; color: var(--anzhiyu-lighttext)">uniapp<sup>1</sup></a><a href="/tags/vim/" style="font-size: 1.05rem; color: rgb(80, 172, 78);">vim<sup>1</sup></a><a href="/tags/vite/" style="font-size: 1.05rem; color: rgb(87, 0, 151);">vite<sup>1</sup></a><a href="/tags/vue/" style="font-size: 1.05rem; color: rgb(0, 197, 114);">vue<sup>1</sup></a><a href="/tags/vue3/" style="font-size: 1.05rem; color: rgb(158, 35, 115);">vue3<sup>1</sup></a><a href="/tags/%E4%BA%91%E6%9C%8D%E5%8A%A1/" style="font-size: 1.05rem; color: rgb(46, 73, 77);">云服务<sup>1</sup></a><a href="/tags/%E5%8F%B3%E9%94%AEcmd/" style="font-size: 1.05rem; color: rgb(127, 38, 73);">右键cmd<sup>1</sup></a><a href="/tags/%E5%B7%A5%E5%85%B7%E7%B1%BB/" style="font-size: 1.05rem; color: rgb(167, 122, 75);">工具类<sup>1</sup></a><a href="/tags/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" style="font-size: 1.05rem; color: rgb(183, 84, 198);">开发环境搭建<sup>1</sup></a><a href="/tags/%E6%96%87%E4%BB%B6%E8%B7%AF%E7%94%B1/" style="font-size: 1.05rem; color: rgb(82, 5, 67);">文件路由<sup>1</sup></a><a href="/tags/%E6%A0%87%E7%AD%BE%E5%A4%96%E6%8C%82/" style="font-size: 1.05rem; color: rgb(109, 196, 189);">标签外挂<sup>1</sup></a><a href="/tags/%E9%9B%B6%E6%95%A3/" style="font-size: 1.05rem; color: rgb(154, 146, 142);">零散<sup>1</sup></a><a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 1.05rem; color: rgb(174, 109, 0);">面试<sup>1</sup></a><a href="/tags/%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA%E8%A7%84%E8%8C%83/" style="font-size: 1.05rem; color: rgb(56, 134, 82);">项目搭建规范<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">六月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">五月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/04/"><span class="card-archive-list-date">四月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/03/"><span class="card-archive-list-date">三月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/02/"><span class="card-archive-list-date">二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/05/"><span class="card-archive-list-date">五月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="热评开关"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/vue3/" itemprop="url">vue3</a></span></div></div><h1 class="post-title" itemprop="name headline">Vue3</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2022-05-27T16:00:00.000Z" title="发表于 2022-05-28 00:00:00">2022-05-28</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-06-03T09:41:16.915Z" title="更新于 2024-06-03 17:41:16">2024-06-03</time></span></div><div class="meta-secondline"></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://s2.loli.net/2022/02/02/QxIWdTG2rFOaRSv.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2022/05/28/Vue3%E5%88%B7%E6%96%87%E6%A1%A3/"><header><a class="post-meta-categories" href="/categories/vue3/" itemprop="url">vue3</a><h1 id="CrawlerTitle" itemprop="name headline">Vue3</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">知瑾</span><time itemprop="dateCreated datePublished" datetime="2022-05-27T16:00:00.000Z" title="发表于 2022-05-28 00:00:00">2022-05-28</time><time itemprop="dateCreated datePublished" datetime="2024-06-03T09:41:16.915Z" title="更新于 2024-06-03 17:41:16">2024-06-03</time></header><h1 id="关于-Vue3"><a href="#关于-Vue3" class="headerlink" title="关于 Vue3"></a>关于 Vue3</h1><h2 id="Vue两个核心"><a href="#Vue两个核心" class="headerlink" title="Vue两个核心?"></a>Vue两个核心?</h2><ol>
<li>声明式渲染：Vue基于标准HTML拓展了一套模板语法，声明式地描述基于JavaScript和Html状态之间的关系。</li>
<li>响应式：Vue 会自动跟踪 JavaScript 状态并在其发生变化时响应式地更新 DOM。</li>
</ol>
<details class="toggle" ><summary class="toggle-button" style="">什么是渐进式框架</summary><div class="toggle-content"><p><strong>官网</strong>：Vue 的设计非常注重灵活性和”可以被逐步集成”这个特点，根据你的需求场景，你可以用不同的方式使用 Vue<br><strong>理解</strong>：除了遵守特定语法之外，不需要考虑其他职责之外的事（你可以只用我的一部分，而不需要了解我职责之外的事情，拿 react 对比，你使用之前还必须要知道什么是副作用，什么是纯函数等等）。</p>
</div></details>


<h2 id="单文件组件？"><a href="#单文件组件？" class="headerlink" title="单文件组件？"></a>单文件组件？</h2><p>类似 HTML 格式的文件来书写 vue 组件，它被称为<strong>单文件组件</strong>（也被称为<code>*.vue</code>文件），Vue 的单文件组件会将一个组件的逻辑 js、html、css 封装在同一个文件里。</p>
<h2 id="选项式和组合式的特点？"><a href="#选项式和组合式的特点？" class="headerlink" title="选项式和组合式的特点？"></a>选项式和组合式的特点？</h2><div class="tabs" id=""><ul class="nav-tabs"><button type="button" class="tab  active" data-href="-1">选项式API</button><button type="button" class="tab " data-href="-2">组合式API</button></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><ol>
<li>选项式 API 用多个选项的对象来描述组件的逻辑，例如data、methods、mounted。选项所定义的属性都会暴露在函数内部的this上，最终都指向当前的组件实例。</li>
<li>选项式 API 以组件实例的概念为中心，它将响应性相关的细节抽象出来，并强制按照选择来组织代码</li>
</ol></div><div class="tab-item-content" id="-2"><ol>
<li>组合式 API 的核心思想是直接在<strong>函数作用域内定义响应式状态变量</strong>，并将多个函数中得到的状态组合起来，处理复杂的问题，这种形式更加自由，灵活性和重用逻辑模式更加强大</li>
</ol></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div>

<h2 id="vite-创建项目命令："><a href="#vite-创建项目命令：" class="headerlink" title="vite 创建项目命令："></a>vite 创建项目命令：</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init vue@latest</span><br></pre></td></tr></table></figure>

<h3 id="vite-中使用-less"><a href="#vite-中使用-less" class="headerlink" title="vite 中使用 less"></a>vite 中使用 less</h3><p>安装命令</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i less-loader less --save-dev</span><br></pre></td></tr></table></figure>

<p>在 vite.config.ts 中引入全局的 less 样式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="title function_">vue</span>()],</span><br><span class="line">  <span class="attr">css</span>: &#123;</span><br><span class="line">    <span class="attr">preprocessorOptions</span>: &#123;</span><br><span class="line">      <span class="attr">less</span>: &#123;</span><br><span class="line">        <span class="attr">modifyVars</span>: &#123;</span><br><span class="line">          <span class="attr">hack</span>: <span class="string">`true; @import (reference) &quot;<span class="subst">$&#123;resolve(</span></span></span><br><span class="line"><span class="subst"><span class="string">            <span class="string">&quot;src/assets/css/base.less&quot;</span></span></span></span><br><span class="line"><span class="subst"><span class="string">          )&#125;</span>&quot;;`</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">javascriptEnabled</span>: <span class="literal">true</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="创建-vue-应用："><a href="#创建-vue-应用：" class="headerlink" title="创建 vue 应用："></a>创建 vue 应用：</h2><h3 id="应用实例"><a href="#应用实例" class="headerlink" title="应用实例"></a>应用实例</h3><p>每个 vue 都通过<strong>createApp</strong>函数创建一个应用实例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 从一个单文件组件中导入根组件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./App.vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>);</span><br></pre></td></tr></table></figure>

<h3 id="挂载应用"><a href="#挂载应用" class="headerlink" title="挂载应用"></a>挂载应用</h3><p>应用实例<strong>app</strong>必须在调用了 .mount() 后才会被渲染出来，mount()方法接受一个容器，接收的参数可以是一个实际的 DOM 元素或是一个 CSS 选择器字符串：</p>
<p> mount() 方法应始终在整个应用配置和资源注册完成后才被调用。返回值是挂载组件的实例而不是非应用实例。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">mount</span>(<span class="string">&quot;#app&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="应用配置"><a href="#应用配置" class="headerlink" title="应用配置"></a>应用配置</h3><p>应用实例<strong>app</strong>会暴露一个.config对象，它允许我们配置一些应用级的选项，例如：全局的错误捕捉，注册全局组件等。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">component</span>(<span class="string">&quot;TodoDeleteButton&quot;</span>, <span class="title class_">Component</span>);</span><br></pre></td></tr></table></figure>

<div class="note warning no-icon flat"><p>应用配置必须在挂载应用实例之前完成！</p>
</div>

<h3 id="挂载多个应用"><a href="#挂载多个应用" class="headerlink" title="挂载多个应用"></a>挂载多个应用</h3><p>应用实例并不只限于一个，可以创建多个共存的应用，通过挂载多个应用来实现，每个应用都有自己的全局配置和全局资源作用域（比如#app和#content是两个应用）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> app1 = <span class="title function_">createApp</span>(&#123;</span><br><span class="line">  <span class="comment">/* ... */</span></span><br><span class="line">&#125;)</span><br><span class="line">app1.<span class="title function_">mount</span>(<span class="string">&#x27;#container-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app2 = <span class="title function_">createApp</span>(&#123;</span><br><span class="line">  <span class="comment">/* ... */</span></span><br><span class="line">&#125;)</span><br><span class="line">app2.<span class="title function_">mount</span>(<span class="string">&#x27;#container-2&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h1 id="响应式基础"><a href="#响应式基础" class="headerlink" title="响应式基础:"></a>响应式基础:</h1><h3 id="声明响应式状态"><a href="#声明响应式状态" class="headerlink" title="声明响应式状态"></a>声明响应式状态</h3><div class="tabs" id=""><ul class="nav-tabs"><button type="button" class="tab  active" data-href="-1">ref</button><button type="button" class="tab " data-href="-2">reactive</button></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><p><strong>官方推荐：</strong> 使用ref()来声明响应式状态。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">count.<span class="property">value</span>; <span class="comment">// 获取值为2（默认值）</span></span><br><span class="line">count.<span class="property">value</span>++; <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>

<p>ref 被传递给函数、或者从一般对象上被解构时，不会丢失响应式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="title function_">ref</span>(<span class="number">1</span>),</span><br><span class="line">  <span class="attr">bar</span>: <span class="title function_">ref</span>(<span class="number">2</span>),</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">readValue</span>(<span class="params">query</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(query.<span class="property">value</span>); <span class="comment">// 需要通过.value取值</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">readValue</span>(obj.<span class="property">foo</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; foo, bar &#125; = obj; <span class="comment">// 不会丢失响应式</span></span><br></pre></td></tr></table></figure>

<details class="toggle" ><summary class="toggle-button" style="">为什么使用ref</summary><div class="toggle-content"><p>Vue会追踪在渲染过程中使用的每一个ref，当某个ref被修改时，都会触发追踪它的组件的一次重新渲染。</p>
<p>内部是通过getter和setter方法来拦截对象属性的get和set操作，**.value**属性允许vue检测ref何时被访问或修改，通过getter来追踪，通过setter来执行触发。</p>
<p>另一个ref好处是，与普通变量不同，ref允许被传递给函数，同时保留对最新值和响应式的连接的访问，有利于复杂逻辑的复用。</p>
</div></details></div><div class="tab-item-content" id="-2"><p>使用<code>reactive()</code>函数创建一个响应式对象或者数组：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; reactive &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123; <span class="attr">count</span>: <span class="number">0</span> &#125;);</span><br></pre></td></tr></table></figure>

<p>特点：</p>
<ol>
<li>仅对<strong>对象类型</strong>有效(对象、数组等集合类型)，而对基础类型 <strong>String</strong>、<strong>Number</strong>、<strong>Boolean</strong>这样的无效。</li>
<li>响应式对象不支持解构。</li>
<li>要保持响应式对象的相同引用，不可以随意替换一个响应式对象，如下：</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> state = <span class="title function_">reactive</span>(&#123; <span class="attr">count</span>: <span class="number">0</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以下行为将丢失响应性</span></span><br><span class="line">state = <span class="title function_">reactive</span>(&#123; <span class="attr">count</span>: <span class="number">1</span> &#125;);</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div>

<h3 id="DOM-更新时机"><a href="#DOM-更新时机" class="headerlink" title="DOM 更新时机"></a>DOM 更新时机</h3><p>修改一个响应式状态时，DOM也会被自动更新，但是更新并不是同步的（是因为vue要确保无论更新多少次响应式数据，组件只会更新一次）。</p>
<p>如果要等待DOM更新完成后再执行额外的代码，可以使用<strong>nextTick</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; nextTick &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">  state.<span class="property">count</span>++;</span><br><span class="line">  <span class="title function_">nextTick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 访问更新后的 DOM</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>另外一种写法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; nextTick &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">  state.<span class="property">count</span>++;</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">nextTick</span>()</span><br><span class="line">  <span class="comment">// dom更新后再执行的代码...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="深层响应性"><a href="#深层响应性" class="headerlink" title="深层响应性"></a>深层响应性</h3><div class="tabs" id=""><ul class="nav-tabs"><button type="button" class="tab  active" data-href="-1">深层响应性</button><button type="button" class="tab " data-href="-2">浅层响应性</button></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><p>Vue 中默认是<strong>深层响应式</strong>的，在更改深层<strong>对象</strong>和<strong>数组</strong>时也是能被检测到的，所以是响应式的。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;reactive&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">nested</span>:&#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">arr</span>: [<span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;bar&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> operateObj &#123;</span><br><span class="line">  obj.<span class="property">nested</span>.<span class="property">count</span> ++</span><br><span class="line">  obj.<span class="property">arr</span>.<span class="title function_">push</span>(<span class="string">&#x27;baz&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="-2"><p>使用<strong>shallowReactive</strong>可以实现只有根级别的数据是响应的</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; shallowReactive, isReactive &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> state = <span class="title function_">shallowReactive</span>(&#123;</span><br><span class="line">  <span class="attr">foo</span>:<span class="number">1</span>,</span><br><span class="line">  <span class="attr">nested</span>: &#123;</span><br><span class="line">    <span class="attr">bar</span>: <span class="number">2</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 是响应式的</span></span><br><span class="line">state.<span class="property">foo</span> ++</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不是响应式的</span></span><br><span class="line">state.<span class="property">nested</span>.<span class="property">bar</span> ++</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不会被转为响应式</span></span><br><span class="line"><span class="title function_">isReactive</span>(state.<span class="property">nested</span>)</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div>

<h3 id="响应式代理-vs-原始对象"><a href="#响应式代理-vs-原始对象" class="headerlink" title="响应式代理 vs 原始对象"></a>响应式代理 vs 原始对象</h3><p>通过reactive创建的响应式对象，是原始对象的代理对象，它和原始对象不相等。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> raw = &#123;&#125;;</span><br><span class="line"><span class="keyword">const</span> proxy = <span class="title function_">reactive</span>(raw);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 代理和原始对象不是全等的</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(proxy === raw); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<ol>
<li>只有代理对象是响应的，更改原始对象不会触发更新，所以仅使用声明对象的代理版本。</li>
<li>对同一个对象调用<strong>reactive</strong>总是返回同样的代理，而对已存在代理调用<strong>reactive</strong>也是返回同样的代理。</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在同一个对象上调用 reactive() 会返回相同的代理</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">reactive</span>(raw) === proxy) <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 在一个代理上调用 reactive() 会返回他自己</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">reactive</span>(proxy) === proxy) <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>以上规则同样适用于<code>嵌套对象</code></p>
<h1 id="计算属性"><a href="#计算属性" class="headerlink" title="计算属性"></a>计算属性</h1><h4 id="基础使用："><a href="#基础使用：" class="headerlink" title="基础使用："></a>基础使用：</h4><p>计算属性通过 getter 函数，返回一个<strong>ref对象</strong>，读取值的时候使用**.value**。</p>
<ol>
<li>在Template模版中使用不需要解包，直接使用函数名。</li>
<li>在Js中使用需要**.value**</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="keyword">import</span> &#123;computed, reactive&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> author = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;zwd&#x27;</span>,</span><br><span class="line">  <span class="attr">books</span>:[]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">  author.<span class="property">books</span> = [<span class="string">&#x27;vue2&#x27;</span>,<span class="string">&#x27;vue3&#x27;</span>,<span class="string">&#x27;vue4&#x27;</span>]</span><br><span class="line">&#125;,<span class="number">2000</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> hasbook = <span class="title function_">computed</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> author.<span class="property">books</span>.<span class="property">length</span> &gt; <span class="number">0</span> ? <span class="string">&#x27;yes&#x27;</span> : <span class="string">&#x27;no&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(hasbook.<span class="property">value</span>);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123;hasbook&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="可修改的计算属性"><a href="#可修改的计算属性" class="headerlink" title="可修改的计算属性"></a>可修改的计算属性</h4><p>当尝试修改一个计算属性时，可以通过<code>getter</code>和<code>setter</code>来创建：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, computed &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> firstName = <span class="title function_">ref</span>(<span class="string">&quot;John&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> lastName = <span class="title function_">ref</span>(<span class="string">&quot;Doe&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fullName = <span class="title function_">computed</span>(&#123;</span><br><span class="line">  <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> data.<span class="property">lastName</span> + data.<span class="property">firstName</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">set</span>(<span class="params">newValue</span>) &#123;</span><br><span class="line">    data.<span class="property">firstName</span> = newValue.<span class="title function_">split</span>(<span class="string">&quot; &quot;</span>)[<span class="number">0</span>] + <span class="string">&quot;hhh&quot;</span>;</span><br><span class="line">    data.<span class="property">lastName</span> = newValue.<span class="title function_">split</span>(<span class="string">&quot; &quot;</span>)[<span class="number">1</span>] + <span class="string">&quot;xxx&quot;</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过某个按钮修改计算属性的值：set(newValue)中newValue会变成&#x27;John Doe&#x27;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleEditLastName</span>(<span class="params"></span>) &#123;</span><br><span class="line">  fullName.<span class="property">value</span> = <span class="string">&quot;John Doe&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="计算属性缓存-vs-方法"><a href="#计算属性缓存-vs-方法" class="headerlink" title="计算属性缓存 vs 方法"></a>计算属性缓存 vs 方法</h4><div class="tabs" id=""><ul class="nav-tabs"><button type="button" class="tab  active" data-href="-1">计算属性</button><button type="button" class="tab " data-href="-2">普通方法</button></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><p><strong>计算属性值会基于其响应式依赖被缓存</strong>，一个计算属性仅会在其<strong>响应式依赖更新时</strong>才重新计算。也就是说，只要依赖不改变，无论多少次访问，都会返回先前的计算结果，而不会重复执行 getter 函数。</p>
<p>以下意味着计算属性永远不会更新，因为 Date.now()并不是一个响应式依赖，它没有依赖任何其他，是一个固定值。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> now = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> <span class="title class_">Date</span>.<span class="title function_">now</span>());</span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="-2"><p><strong>方法总是在每次渲染时都会再次执行</strong>，模板中也使用方法直接调用来获取对应的依赖结果：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">calculateBooksMessage</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> author.<span class="property">books</span>.<span class="property">length</span> &gt; <span class="number">0</span> ? <span class="string">&quot;yes&quot;</span> : <span class="string">&quot;no&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; calculateBooksMessage() &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div>

<h4 id="计算属性使用注意点："><a href="#计算属性使用注意点：" class="headerlink" title="计算属性使用注意点："></a>计算属性使用注意点：</h4><ol>
<li>计算函数不应该有副作用（不要在计算函数中做<strong>异步请求</strong>或者<strong>更改 DOM</strong>）</li>
<li>避免直接修改计算属性值（计算属性返回值是只读的，更新计算值应该由它所依赖的源状态触发）</li>
</ol>
<h2 id="侦听器"><a href="#侦听器" class="headerlink" title="侦听器"></a>侦听器</h2><p>watch 监听某个属性，每次响应式状态发生变化时触发回调函数</p>
<h3 id="基础侦听"><a href="#基础侦听" class="headerlink" title="基础侦听"></a>基础侦听</h3><p>watch 的第一个参数： 可以是 ref（包括计算属性）、响应式对象、一个 getter 函数，或者多个来源组成的数组</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> x = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">const</span> y = <span class="title function_">ref</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 单个ref</span></span><br><span class="line"><span class="title function_">watch</span>(x, <span class="function">(<span class="params">newValue</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`newValue == <span class="subst">$&#123;newValue&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// getter函数</span></span><br><span class="line"><span class="title function_">watch</span>(</span><br><span class="line">  <span class="function">() =&gt;</span> x.<span class="property">value</span> + y.<span class="property">value</span>,</span><br><span class="line">  <span class="function">(<span class="params">sum</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`sum of x + y is: <span class="subst">$&#123;sum&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 多个来源组成的数组</span></span><br><span class="line"><span class="title function_">watch</span>([x, <span class="function">() =&gt;</span> y.<span class="property">value</span>], <span class="function">(<span class="params">[newX, newY]</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`x is <span class="subst">$&#123;newX&#125;</span> and y is <span class="subst">$&#123;newY&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>注意，不能侦听响应式对象的属性，例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = <span class="title function_">reactive</span>(&#123; <span class="attr">count</span>: <span class="number">0</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这不起作用，因为你向 watch() 传入了一个 number</span></span><br><span class="line"><span class="title function_">watch</span>(obj.<span class="property">count</span>, <span class="function">(<span class="params">count</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`count is: <span class="subst">$&#123;count&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>正确的使用方式：提供一个<code>getter</code>函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 提供一个 getter 函数</span></span><br><span class="line"><span class="title function_">watch</span>(</span><br><span class="line">  <span class="function">() =&gt;</span> obj.<span class="property">count</span>,</span><br><span class="line">  <span class="function">(<span class="params">count</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`count is: <span class="subst">$&#123;count&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="深层侦听"><a href="#深层侦听" class="headerlink" title="深层侦听"></a>深层侦听</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = <span class="title function_">reactive</span>(&#123; <span class="attr">count</span>: <span class="number">0</span> &#125;);</span><br><span class="line"><span class="title function_">watch</span>(obj, <span class="function">(<span class="params">newObj, oldObj</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// newObj 和 oldObj 相等 引用类型 同一个对象</span></span><br><span class="line">&#125;);</span><br><span class="line">obj.<span class="property">count</span>++;</span><br></pre></td></tr></table></figure>

<p>不同于 getter 函数，只有 getter 函数的 count 更新，才会触发</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">watch</span>(</span><br><span class="line">  <span class="function">() =&gt;</span> obj.<span class="property">count</span>,</span><br><span class="line">  <span class="function">(<span class="params">count</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`count is: <span class="subst">$&#123;count&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>将 getter 函数侦听，隐式转换深层侦听</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">watch</span>(</span><br><span class="line">  <span class="function">() =&gt;</span> obj.<span class="property">count</span>,</span><br><span class="line">  <span class="function">(<span class="params">count</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`count is: <span class="subst">$&#123;count&#125;</span>`</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; <span class="attr">deep</span>: <span class="literal">true</span> &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="watchEffect"><a href="#watchEffect" class="headerlink" title="watchEffect"></a>watchEffect</h3><p>watchEffect 在创建侦听器时，会立即执行一遍回调</p>
<p>正常监听</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> url = <span class="title function_">ref</span>(<span class="string">&quot;https://...&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> data = <span class="title function_">ref</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchData</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(url.<span class="property">value</span>);</span><br><span class="line">  data.<span class="property">value</span> = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 立即获取</span></span><br><span class="line"><span class="title function_">fetchData</span>();</span><br><span class="line"><span class="comment">// ...再侦听 url 变化</span></span><br><span class="line"><span class="title function_">watch</span>(url, fetchData);</span><br></pre></td></tr></table></figure>

<p>改成 watchEffect</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">watchEffect</span>(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(url.<span class="property">value</span>);</span><br><span class="line">  data.<span class="property">value</span> = <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>上面的例子中，会先执行一次回调，自动追踪<code>url.value</code>（相当于计算属性）,每当<code>url.value</code>变化，会再次触发回调。</p>
<p>不同之处：</p>
<table>
<thead>
<tr>
<th>watch</th>
<th>watchEffect</th>
</tr>
</thead>
<tbody><tr>
<td>只追踪明确的侦听源，不追踪回调内访问的属性</td>
<td>在副作用发生时追踪依赖</td>
</tr>
<tr>
<td>只有在响应源改变时才会触发回调</td>
<td>自动追踪所有能访问到的响应式属性</td>
</tr>
<tr>
<td>更好的控制回调的触发时机</td>
<td>代码简洁，但其响应依赖关系不明确</td>
</tr>
</tbody></table>
<h3 id="回调的刷新时机"><a href="#回调的刷新时机" class="headerlink" title="回调的刷新时机"></a>回调的刷新时机</h3><p>默认情况，侦听器内访问 DOM 是<code>Vue更新之前的DOM</code>，若想在回调中访问 Vue 更新后的 DOM，可以添加属性<code>flush: post</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">watch</span>(sourse, callback, &#123;</span><br><span class="line">  <span class="attr">flush</span>: <span class="string">&quot;post&quot;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="title function_">watchEffect</span>(callback, &#123;</span><br><span class="line">  <span class="attr">flush</span>: <span class="string">&quot;post&quot;</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>watchEffect 的回调刷新别名: <code>watchPostEffect()</code>，而不需要<code>flush:post</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; watchPostEffect &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="title function_">watchPostEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">/* 在 Vue 更新后执行 */</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="取消监听"><a href="#取消监听" class="headerlink" title="取消监听"></a>取消监听</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> unwatch = <span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> &#123;&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...当该侦听器不再需要时</span></span><br><span class="line"><span class="title function_">unwatch</span>();</span><br></pre></td></tr></table></figure>

<p>需要异步创建侦听器的情况很少，请尽可能选择同步创建。如果需要等待一些异步数据，你可以使用条件式的侦听逻辑：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 需要异步请求得到的数据</span></span><br><span class="line"><span class="keyword">const</span> data = <span class="title function_">ref</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (data.<span class="property">value</span>) &#123;</span><br><span class="line">    <span class="comment">// 数据加载后执行某些操作...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="类与样式的绑定"><a href="#类与样式的绑定" class="headerlink" title="类与样式的绑定"></a>类与样式的绑定</h2><div class="tabs" id=""><ul class="nav-tabs"><button type="button" class="tab  active" data-href="-1">HTML绑定class</button><button type="button" class="tab " data-href="-2">绑定内联样式</button></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><p>绑定对象</p>
<p>两个类<code>active和text-danger</code>的显示取决于布尔值<code>isActive</code>和<code>hasError</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:class</span>=<span class="string">&quot;&#123; active: isActive, &#x27;text-danger&#x27;: hasError &#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以通过计算属性来绑定：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, computed &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> isActive = <span class="title function_">ref</span>(<span class="literal">true</span>);</span><br><span class="line"><span class="keyword">const</span> error = <span class="title function_">ref</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> classObject = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> (&#123;</span><br><span class="line">  <span class="attr">active</span>: isActive.<span class="property">value</span> &amp;&amp; !error.<span class="property">value</span>,</span><br><span class="line">  <span class="string">&quot;text-danger&quot;</span>: error.<span class="property">value</span> &amp;&amp; error.<span class="property">value</span>.<span class="property">type</span> === <span class="string">&quot;fatal&quot;</span>,</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:class</span>=<span class="string">&quot;classObject&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 转换后 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;active text-danger&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">divdiv</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>绑定数组</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> activeClass = <span class="title function_">ref</span>(<span class="string">&quot;active&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> errorClass = <span class="title function_">ref</span>(<span class="string">&quot;text-danger&quot;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:class</span>=<span class="string">&quot;[activeClass, errorClass]&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 使用三元判断 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:class</span>=<span class="string">&quot;[isActive ? activeClass : &#x27;&#x27;, errorClass]&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 使用isActive真假动态添加active--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:class</span>=<span class="string">&quot;[&#123; active: isActive &#125;, errorClass]&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>组件绑定 class</p>
<p>普通绑定</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">my-component</span> <span class="attr">class</span>=<span class="string">&quot;baz&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">my-component</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 组件内 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;baz&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>动态绑定</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">my-component</span> <span class="attr">:class</span>=<span class="string">&quot;&#123; active: isActive &#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">my-component</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>若想组件内某个元素接收这个 class，可以通过组件的<code>$attrs</code>来实现：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">my-component</span> <span class="attr">class</span>=<span class="string">&quot;baz&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">my-component</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- my-component 模板使用 $attrs 时 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">:class</span>=<span class="string">&quot;$attrs.class&quot;</span>&gt;</span>Hi!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>This is a child component<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 最终渲染成 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;baz&quot;</span>&gt;</span>Hi!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>This is a child component<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="-2"><p>普通绑定</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> activeColor = <span class="title function_">ref</span>(<span class="string">&quot;red&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fontSize = <span class="title function_">ref</span>(<span class="number">30</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:style</span>=<span class="string">&quot;&#123; color: activeColor, fontSize: fontSize + &#x27;px&#x27; &#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>绑定对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> styleObject = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">color</span>: <span class="string">&quot;red&quot;</span>,</span><br><span class="line">  <span class="attr">fontSize</span>: <span class="string">&quot;13px&quot;</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:style</span>=<span class="string">&quot;styleObject&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>绑定数组</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:style</span>=<span class="string">&quot;[baseStyles, overridingStyles]&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div>

<h2 id="条件渲染"><a href="#条件渲染" class="headerlink" title="条件渲染"></a>条件渲染</h2><p><strong>指令：</strong></p>
<ol>
<li><code>v-if</code>:是真实的按条件渲染，是一种懒加载的渲染，若初次渲染为 fasle，则不会做任何事，直到条件改变为 true 的时候才会渲染</li>
<li><code>v-show</code>元素无论初始条件为真假，始终存在于 DOM 中。</li>
</ol>
<p><strong>优化：</strong></p>
<p>频繁切换使用 v-show，运行时不经常改变用 v-if：</p>
<p><strong>v-if 和 v-for 不同时使用：</strong></p>
<p>v-if 和 v-for 不能同时使用，因为<code>v-if的优先级比较高</code>，执行的时候会<code>先执行v-if</code>，而<code>增加内存消耗</code></p>
<h2 id="列表渲染"><a href="#列表渲染" class="headerlink" title="列表渲染"></a>列表渲染</h2><div class="tabs" id=""><ul class="nav-tabs"><button type="button" class="tab  active" data-href="-1">循环数组</button><button type="button" class="tab " data-href="-2">循环对象</button></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;(item, index) in items&quot;</span>&gt;</span></span><br><span class="line">  &#123;&#123; parentMessage &#125;&#125; - &#123;&#123; index &#125;&#125; - &#123;&#123; item.message &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="-2"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myObject = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="string">&quot;How to do lists in Vue&quot;</span>,</span><br><span class="line">  <span class="attr">author</span>: <span class="string">&quot;Jane Doe&quot;</span>,</span><br><span class="line">  <span class="attr">publishedAt</span>: <span class="string">&quot;2016-04-10&quot;</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;(value, key, index) in myObject&quot;</span>&gt;</span></span><br><span class="line">  &#123;&#123; index &#125;&#125;. &#123;&#123; key &#125;&#125;: &#123;&#123; value &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div>

<p>可以在<code>template</code>上使用<code>v-for</code>,小程序的<code>block</code>也是一样：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-for</span>=<span class="string">&quot;item in items&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;&#123; item.msg &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;divider&quot;</span> <span class="attr">role</span>=<span class="string">&quot;presentation&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>有时候希望展示经过过滤或排序后的内容，可以使用已过滤或已排序数组的计算属性</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> numbers = <span class="title function_">ref</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> evenNumbers = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> numbers.<span class="property">value</span>.<span class="title function_">filter</span>(<span class="function">(<span class="params">n</span>) =&gt;</span> n % <span class="number">2</span> === <span class="number">0</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="事件绑定"><a href="#事件绑定" class="headerlink" title="事件绑定"></a>事件绑定</h2><h3 id="基础修饰符："><a href="#基础修饰符：" class="headerlink" title="基础修饰符："></a>基础修饰符：</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 单击事件将停止传递 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> @<span class="attr">click.stop</span>=<span class="string">&quot;doThis&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 提交事件将不再重新加载页面 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> @<span class="attr">submit.prevent</span>=<span class="string">&quot;onSubmit&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 修饰语可以使用链式书写 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> @<span class="attr">click.stop.prevent</span>=<span class="string">&quot;doThat&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 也可以只有修饰符 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> @<span class="attr">submit.prevent</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 仅当 event.target 是元素本身时才会触发事件处理器 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 例如：事件处理器不来自子元素 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> @<span class="attr">click.self</span>=<span class="string">&quot;doThat&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 在 &quot;change&quot; 事件后同步更新而不是 &quot;input&quot; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model.lazy</span>=<span class="string">&quot;msg&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 用户输入自动转换为数字 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model.number</span>=<span class="string">&quot;age&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 默认自动去除用户输入内容中两端的空格 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model.trim</span>=<span class="string">&quot;msg&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="按键修饰符："><a href="#按键修饰符：" class="headerlink" title="按键修饰符："></a>按键修饰符：</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 仅在 <span class="string">`key`</span> 为 <span class="string">`Enter`</span> 时调用 <span class="string">`vm.submit()`</span> --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">input</span> @<span class="attr">keyup.enter</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span></span><br></pre></td></tr></table></figure>

<h2 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h2><table>
<thead>
<tr>
<th>生命周期</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>onMounted</td>
<td>在<code>组件挂载完成后执行</code>（包含了所有同步组件的加载、DOM 树创建并挂载到父容器中、不包含异步组件<Suspense>）</td>
</tr>
<tr>
<td>onUpdated</td>
<td>在组件因为响应式状态变更而更新其 DOM 树之后调用，如果需特定的状态改变后才调用，使用<code>nextTick</code></td>
</tr>
<tr>
<td>onUnmounted</td>
<td>在组件实例被卸载之后调用（清除定时器、取消监听、销毁 socket）</td>
</tr>
<tr>
<td>onBeforeMount</td>
<td>在组件被挂载之前被调用，当这个钩子被调用时，组件已经完成了其响应式状态的设置，但还没有创建 DOM 节点。它即将首次执行 DOM 渲染过程</td>
</tr>
<tr>
<td>onBeforeUpdate</td>
<td>在组件即将因为响应式状态变更而更新其 DOM 树之前调用</td>
</tr>
<tr>
<td>onBeforeUnmount</td>
<td>在组件实例被卸载之前调用</td>
</tr>
<tr>
<td>onErrorCaptured</td>
<td>在捕获了后代组件传递的错误时调用</td>
</tr>
<tr>
<td>onRenderTracked</td>
<td>当响应式依赖被组件的渲染作用追踪后调用（<strong>这个钩子仅在开发模式下可用，且在服务器端渲染期间不会被调用</strong>）</td>
</tr>
<tr>
<td>onRenderTriggered</td>
<td>当响应式依赖触发了组件渲染作用的运行之后调用（<strong>这个钩子仅在开发模式下可用，且在服务器端渲染期间不会被调用</strong>）</td>
</tr>
<tr>
<td>onActivated</td>
<td>若组件实例是<code>&lt;keepAlive&gt;</code>缓存树的一部分，当组件被插入到 DOM 中时调用</td>
</tr>
<tr>
<td>onDeactivated</td>
<td>若组件实例是<code>&lt;keepAlive&gt;</code>缓存树的一部分，当组件从 DOM 中被移除时调用</td>
</tr>
</tbody></table>
<h2 id="依赖注入"><a href="#依赖注入" class="headerlink" title="依赖注入"></a>依赖注入</h2><p>提供一个值，供后代组件使用</p>
<p>与注册生命周期钩子的 API 类似，<code>provide()</code> 必须在组件的 <code>setup()</code> 阶段同步调用</p>
<div class="tabs" id=""><ul class="nav-tabs"><button type="button" class="tab  active" data-href="-1">provide</button><button type="button" class="tab " data-href="-2">inject</button></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><p>为组件后代供给数据，一个组件可以多次调用<code>provide()</code>，使用不同的注入名，注入不同的依赖值。</p>
<p>参数一： <code>key</code></p>
<p>参数二：<code>value</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; provide, ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// provide静态值</span></span><br><span class="line"><span class="title function_">provide</span>(<span class="string">&quot;foo&quot;</span>, <span class="string">&quot;bar&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// provide响应式的值</span></span><br><span class="line"><span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">5</span>);</span><br><span class="line"><span class="title function_">provide</span>(<span class="string">&quot;count&quot;</span>, count);</span><br></pre></td></tr></table></figure>

<p>若不使用<code>setup</code>，确保<code>provide()</code> 是在 <code>setup()</code> 同步调用的：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; provide &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">provide</span>(<span class="comment">/* 注入名 */</span> <span class="string">&quot;message&quot;</span>, <span class="comment">/* 值 */</span> <span class="string">&quot;hello!&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>应用层 Provide</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(&#123;&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">provide</span>(<span class="comment">/* 注入名 */</span> <span class="string">&quot;message&quot;</span>, <span class="comment">/* 值 */</span> <span class="string">&quot;hello!&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>应用级的供给在应用的所有组件中都可以注入。</p>
<p>编写<code>插件</code>时会特别有用，因为<code>插件一般都不会使用组件形式来供给值</code>。</p>
<p><strong>只读</strong></p>
<p>若想确保从祖先传递的值不被组件更改，你可以使用<code>readonly()</code>来包装提供的值。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, provide, readonly &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_">provide</span>(<span class="string">&quot;read-only-count&quot;</span>, <span class="title function_">readonly</span>(count));</span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="-2"><p><strong>注入供给的值</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">  <span class="keyword">import</span> &#123;inject&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span> <span class="keyword">import</span> &#123;fooSymbol&#125; <span class="keyword">from</span> <span class="string">&#x27;./injectionSymbols&#x27;</span> <span class="comment">//</span></span><br><span class="line">  注入值的默认方式 <span class="keyword">const</span> foo = <span class="title function_">inject</span>(<span class="string">&#x27;foo&#x27;</span>) <span class="comment">// 注入响应式的值 const count =</span></span><br><span class="line">  <span class="title function_">inject</span>(<span class="string">&#x27;count&#x27;</span>) <span class="comment">// 通过 Symbol 类型的 key 注入 const foo2 = inject(fooSymbol)</span></span><br><span class="line">  <span class="comment">// 注入一个值，若为空则使用提供的默认值 const bar = inject(&#x27;foo&#x27;, &#x27;default</span></span><br><span class="line">  value<span class="string">&#x27;) // 注入一个值，若为空则使用提供的工厂函数 const baz = inject(&#x27;</span>foo<span class="string">&#x27;, ()</span></span><br><span class="line"><span class="string">  =&gt; new Map()) // 注入时为了表明提供的默认值是个函数，需要传入第三个参数 const</span></span><br><span class="line"><span class="string">  fn = inject(&#x27;</span><span class="keyword">function</span><span class="string">&#x27;, () =&gt; &#123;&#125;, false)</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div>

<h2 id="内置组件"><a href="#内置组件" class="headerlink" title="内置组件"></a>内置组件</h2><p>内置组件无需注册可以直接在模板中使用，只有使用时才会包含在构建中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Transtion</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Transtion"><a href="#Transtion" class="headerlink" title="Transtion"></a>Transtion</h3><p>仅支持为单个元素或组件提供动画过度效果，如果内容是一个组件，这个组件必须仅有一个根元素</p>
<p>动画的触发条件是：</p>
<ol>
<li>由<code>v-if</code></li>
<li>由<code>v-show</code></li>
<li>由特殊元素<code>&lt;component&gt;</code>切换的动态组件</li>
</ol>
<h4 id="为过渡命名"><a href="#为过渡命名" class="headerlink" title="为过渡命名"></a>为过渡命名</h4><p>通过一个<code>name</code>prop 声明一种过渡</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Transition</span> <span class="attr">name</span>=<span class="string">&quot;fade&quot;</span>&gt;</span> ... <span class="tag">&lt;/<span class="name">Transition</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>对于已命名的过渡，它的过渡相关 class 会以其名字而不是 v 作为前缀。</p>
<p>比如上方的例子，相关 class 会是<code>fade-enter-active</code>而不是<code>v-enter-active</code></p>
<p>这个<code>fade</code>的 class 应该是：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.fade-enter-active</span>,</span><br><span class="line"><span class="selector-class">.fade-leave-active</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: opacity <span class="number">0.5s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.fade-enter-from</span>,</span><br><span class="line"><span class="selector-class">.fade-leave-to</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="自定义过渡-class"><a href="#自定义过渡-class" class="headerlink" title="自定义过渡 class"></a>自定义过渡 class</h4><p>可以使用第三方库 Animate.css</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Transition</span></span></span><br><span class="line"><span class="tag">  <span class="attr">name</span>=<span class="string">&quot;custom-classes&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">enter-active-class</span>=<span class="string">&quot;animate__animated animate__tada&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">leave-active-class</span>=<span class="string">&quot;animate__animated animate__bounceOutRight&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-if</span>=<span class="string">&quot;show&quot;</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Transition</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="出现时过渡"><a href="#出现时过渡" class="headerlink" title="出现时过渡"></a>出现时过渡</h4><p>想要初次渲染就有过渡动画，添加<code>apper</code>属性</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Transition</span> <span class="attr">appear</span>&gt;</span> ... <span class="tag">&lt;/<span class="name">Transition</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="组件间过渡"><a href="#组件间过渡" class="headerlink" title="组件间过渡"></a>组件间过渡</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Transition</span> <span class="attr">name</span>=<span class="string">&quot;fade&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;out-in&quot;</span> <span class="attr">appear</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;view&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Transition</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="监听过渡事件"><a href="#监听过渡事件" class="headerlink" title="监听过渡事件"></a>监听过渡事件</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Transition</span> @<span class="attr">after-enter</span>=<span class="string">&quot;onTransitionComplete&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-show</span>=<span class="string">&quot;ok&quot;</span>&gt;</span>toggled content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Transition</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="TransitionGroup"><a href="#TransitionGroup" class="headerlink" title="TransitionGroup"></a>TransitionGroup</h4><p>为列表中的<strong>多个</strong>元素或组件提供过渡效果。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">TransitionGroup</span> <span class="attr">tag</span>=<span class="string">&quot;ul&quot;</span> <span class="attr">name</span>=<span class="string">&quot;slide&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;item in items&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item.id&quot;</span>&gt;</span>&#123;&#123; item.text &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">TransitionGroup</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="KeepAlive"><a href="#KeepAlive" class="headerlink" title="KeepAlive"></a>KeepAlive</h3><p>缓存包裹在其中的动态切换组件。keepAlive 包裹动态组件时，会缓存不活跃的组件实例，而不是销毁它们。</p>
<p>当一个组件在 <code>&lt;KeepAlive&gt;</code> 中被切换时，它的 <code>activated</code> 和 <code>deactivated</code> 生命周期钩子将被调用，用来替代 <code>mounted</code> 和 <code>unmounted</code>。这适用于 <code>&lt;KeepAlive&gt;</code> 的直接子节点及其所有子孙节点。</p>
<p>基本用法：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">KeepAlive</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;view&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">KeepAlive</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>与 Transition 一起使用：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Transition</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">KeepAlive</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;view&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">KeepAlive</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Transition</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>使用 include、exclude</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 用逗号分隔的字符串 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">KeepAlive</span> <span class="attr">include</span>=<span class="string">&quot;a,b&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;view&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">KeepAlive</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 正则表达式 (使用 `v-bind`) --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">KeepAlive</span> <span class="attr">:include</span>=<span class="string">&quot;/a|b/&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;view&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">KeepAlive</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 数组 (使用 `v-bind`) --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">KeepAlive</span> <span class="attr">:include</span>=<span class="string">&quot;[&#x27;a&#x27;, &#x27;b&#x27;]&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;view&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">KeepAlive</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Teleport"><a href="#Teleport" class="headerlink" title="Teleport"></a>Teleport</h3><p>将插槽内容渲染到 DOM 的另一个部分。</p>
<p>指定目标容器：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">teleport</span> <span class="attr">to</span>=<span class="string">&quot;#some-id&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">teleport</span> <span class="attr">to</span>=<span class="string">&quot;.some-class&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">teleport</span> <span class="attr">to</span>=<span class="string">&quot;[data-teleport]&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>有条件的禁用：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">teleport</span> <span class="attr">to</span>=<span class="string">&quot;#popup&quot;</span> <span class="attr">:disabled</span>=<span class="string">&quot;displayVideoInline&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">video</span> <span class="attr">src</span>=<span class="string">&quot;./my-movie.mp4&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">teleport</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Suspense"><a href="#Suspense" class="headerlink" title="Suspense"></a>Suspense</h3><p>用于在组件树中编排嵌套的异步依赖项。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/default_cover.jpg&quot;" data-lazy-src="https://s2.loli.net/2022/06/15/NtCT5Heumj9wfhD.png"></p>
<p>假设组件树中有多个嵌套组件，要渲染出它们，首先得解析一些异步资源。</p>
<p>它们每个都需要处理自己的加载、报错和完成状态。</p>
<p>在最坏的情况下，我们可能会在页面上看到三个旋转的加载态，在不同的时间显示出内容。</p>
<p>有了<code>Suspense</code>之后，就可以在等待整个多层级组件树中的各个<code>异步依赖获取结果时</code>，才展示出加载中或加载失败的状态。</p>
<p><code>Suspense</code>可以等待的异步依赖有两种：</p>
<ol>
<li>带有异步 <code>setup()</code> 钩子的组件。这也包含了使用 <code>&lt;script setup&gt;</code> 时有顶层 <code>await</code> 表达式的组件。</li>
<li>异步组件。</li>
</ol>
<h4 id="async-setup（）"><a href="#async-setup（）" class="headerlink" title="async setup（）"></a>async setup（）</h4><p>在组合式 API 中的<code>setup()</code>可以是异步的：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(...)</span><br><span class="line">    <span class="keyword">const</span> posts = <span class="keyword">await</span> res.<span class="title function_">json</span>()</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      posts</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>setup</code>语法糖中，顶层 <code>await</code> 表达式会自动让该组件成为一个异步依赖</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(...) <span class="keyword">const</span> posts = <span class="keyword">await</span> res.<span class="title function_">json</span>()</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h4 id="加载中状态"><a href="#加载中状态" class="headerlink" title="加载中状态"></a>加载中状态</h4><p><code>&lt;Suspense&gt;</code>接受两个插槽： <code>#default</code>和<code>#fallback</code>它将在内存中<code>渲染默认插槽</code>的<code>同时展示后备插槽内容</code>。</p>
<p>如果在渲染时遇到异步依赖项（<code>异步组件</code>和具有<code>async setup()</code>的组件），它会<code>等所有异步依赖项解析完成时再显示默认插槽</code>。</p>
<p>示例：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Suspense</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 具有深层异步依赖的组件 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">DashboardCom</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 在 #fallback 插槽中显示 “正在加载中” --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> #<span class="attr">fallback</span>&gt;</span> Loading ... <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在默认组件<code>&lt;DashboardCom /&gt;</code>中：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> tips = <span class="title function_">ref</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="title function_">a</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(<span class="string">&quot;具有深层异步依赖的组件&quot;</span>);</span><br><span class="line">    &#125;, <span class="number">2000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">await</span> <span class="title function_">a</span>().<span class="title function_">then</span>(<span class="function">(<span class="params">ret</span>) =&gt;</span> &#123;</span><br><span class="line">  tips.<span class="property">value</span> = ret;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>所以<code>&lt;DashboardCom /&gt;</code>组件将会在 2 秒后才进行渲染</p>
<h3 id="内置组件结合使用："><a href="#内置组件结合使用：" class="headerlink" title="内置组件结合使用："></a>内置组件结合使用：</h3><p>要保证这些组件都能正常使用，嵌套顺序非常重要。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">RouterView</span> <span class="attr">v-slot</span>=<span class="string">&quot;&#123; Component &#125;&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;Component&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Transition</span> <span class="attr">mode</span>=<span class="string">&quot;out-in&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">KeepAlive</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Suspense</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- 主要内容 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;Component&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- 加载中状态 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">template</span> #<span class="attr">fallback</span>&gt;</span> 正在加载... <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">KeepAlive</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Transition</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">RouterView</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="模板-ref"><a href="#模板-ref" class="headerlink" title="模板 ref"></a>模板 ref</h2><div class="tabs" id=""><ul class="nav-tabs"><button type="button" class="tab  active" data-href="-1">模板ref</button><button type="button" class="tab " data-href="-2">函数ref</button><button type="button" class="tab " data-href="-3">组件上的ref</button></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><p>需要操作 DOM 元素的时候，给元素绑定 ref</p>
<p>在 Vue3 中绑定 ref，需要先声明一个同名的 ref</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&quot;input1&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, onMounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明一个 ref 来存放该元素的引用</span></span><br><span class="line"><span class="comment">// 必须和模板 ref 同名</span></span><br><span class="line"><span class="keyword">const</span> input1 = ref&lt;&gt;(<span class="literal">null</span>)</span><br><span class="line"></span><br><span class="line"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  input1.<span class="property">value</span>.<span class="title function_">focus</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="-2"><p>除了给<code>ref</code>绑定字符串之外，还可以绑定一个函数，在每次组件更新时函数都被调用。函数接受该元素引用作为第一个参数</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">:ref</span>=<span class="string">&quot;(el) =&gt; &#123; /* 将 el 分配给 property 或 ref */ &#125;&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="-3"><p>当 ref 被应用到组件上时，ref 将引用的是组件实例</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Child</span> <span class="attr">ref</span>=<span class="string">&quot;child&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> child = <span class="title function_">ref</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// child.value 是 &lt;Child /&gt; 组件的实例</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>此时父组件可以通过<code>child</code>访问子组件中的任何属性和方法</p>
<p>有一种特殊情况，如果子组件使用<code>&lt;script setup&gt;</code>语法糖，父组件将访问不到子组件的属性和方法，可以通过<code>defineExpose</code>宏函数暴露子组件的属性和方法，让父组件能完全访问到：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 子组件Child中：</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">const</span> b = <span class="title function_">ref</span>(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">defineExpose</span>(&#123;</span><br><span class="line">  a,</span><br><span class="line">  b,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父组件中 (ref 都会自动解包，和一般的实例一样)</span></span><br><span class="line"><span class="keyword">const</span> child = <span class="title function_">ref</span>(<span class="literal">null</span>);</span><br><span class="line">child.<span class="property">value</span>; <span class="comment">// =&gt; &#123; a: 1, b: 2 &#125;</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div>

<h2 id="组件基础"><a href="#组件基础" class="headerlink" title="组件基础"></a>组件基础</h2><h3 id="组件定义"><a href="#组件定义" class="headerlink" title="组件定义"></a>组件定义</h3><div class="tabs" id=""><ul class="nav-tabs"><button type="button" class="tab  active" data-href="-1">单文件组件</button><button type="button" class="tab " data-href="-2">不用setup语法糖</button></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><p>vue 文件方式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;count++&quot;</span>&gt;</span>You clicked me &#123;&#123; count &#125;&#125; times.<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="-2"><p><code>template</code>方式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      count,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">template</span>: <span class="string">`</span></span><br><span class="line"><span class="string">  	&lt;button @click=&quot;count++&quot;&gt;</span></span><br><span class="line"><span class="string">     You clicked me &#123;&#123; count &#125;&#125; times.</span></span><br><span class="line"><span class="string">   &lt;/button&gt;</span></span><br><span class="line"><span class="string">  `</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div>

<h3 id="组件传值"><a href="#组件传值" class="headerlink" title="组件传值"></a>组件传值</h3><p>若使用 setup 语法糖，在<code>子组件</code>中需要通过：</p>
<ol>
<li><code>defineProps</code>定义<code>可接受的props的属性</code>，并且声明的 props 会自动暴露给模板。</li>
<li><code>defineProps</code>会返回一个对象。</li>
<li><code>defineProps</code>的参数和父组件提供的 props 的值是相同的</li>
</ol>
<div class="tabs" id=""><ul class="nav-tabs"><button type="button" class="tab  active" data-href="-1">setup语法</button><button type="button" class="tab " data-href="-2">不使用setup语法糖</button></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><p><strong>接收字符串形式</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> props = <span class="title function_">defineProps</span>([<span class="string">&quot;title&quot;</span>]);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(props.<span class="property">title</span>);</span><br></pre></td></tr></table></figure>

<p><strong>接收对象形式</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> props = <span class="title function_">defineProps</span>(&#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="title class_">String</span>,</span><br><span class="line">  <span class="attr">likes</span>: <span class="title class_">Number</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>传递多个 props 时的可以使用 v-bind</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父组件</span></span><br><span class="line"><span class="keyword">const</span> post = &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">title</span>: <span class="string">&quot;this is title&quot;</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">BlogPost</span> <span class="attr">v-bind</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 等价于 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">BlogPost</span> <span class="attr">:id</span>=<span class="string">&quot;post.id&quot;</span> <span class="attr">:title</span>=<span class="string">&quot;post.title&quot;</span>&gt;</span>&lt;/BlogPost</span><br><span class="line">&gt;<span class="tag">&lt;/<span class="name">BlogPost</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>循环组件可以使用<code>v-for</code>的形式</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> posts = <span class="title function_">ref</span>([</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">title</span>: <span class="string">&quot;My journey with Vue&quot;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">title</span>: <span class="string">&quot;Blogging with Vue&quot;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">title</span>: <span class="string">&quot;Why Vue is so fun&quot;</span> &#125;,</span><br><span class="line">]);</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">BlogPost</span> <span class="attr">v-for</span>=<span class="string">&quot;post in posts&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;post.id&quot;</span> <span class="attr">:title</span>=<span class="string">&quot;post.title&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 等价于 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">BlogPost</span> <span class="attr">title</span>=<span class="string">&quot;My journey with Vue&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">BlogPost</span> <span class="attr">title</span>=<span class="string">&quot;Blogging with Vue&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">BlogPost</span> <span class="attr">title</span>=<span class="string">&quot;Why Vue is so fun&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>数据单向流</strong></p>
<p>所有 prop 都遵循<code>单向绑定原则</code>,prop 因父组件的更新而变化，自然会将新的状态向下传递，是不可逆的。</p>
<p>子组件修改父组件 prop：</p>
<ol>
<li><p><code>在子组件中新定义一个局部属性，从prop中获取初始值</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> props = <span class="title function_">defineProps</span>([<span class="string">&quot;initalCount&quot;</span>]);</span><br><span class="line"><span class="keyword">const</span> couter = <span class="title function_">ref</span>(props.<span class="property">initalCount</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>prop以原始的形式传入，使用计算属性转换</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> props = <span class="title function_">defineProps</span>([<span class="string">&quot;initalCount&quot;</span>]);</span><br><span class="line"><span class="keyword">const</span> normalize = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> props.<span class="property">initalCount</span>.<span class="title function_">tirm</span>().<span class="title function_">toLowerCase</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>自定义事件</strong></p>
<p>通过<code>defineEmits</code>定义自定义事件名</p>
<p>子组件定义<code>emit发射事件</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> emit = <span class="title function_">defineEmits</span>([<span class="string">&quot;custom&quot;</span>]);</span><br><span class="line"><span class="title function_">emit</span>(<span class="string">&quot;custom&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>父组件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> @<span class="attr">custom</span>=<span class="string">&quot;custom&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="-2"><p><code>props</code>对象会作为 setup 函数的第一个参数</p>
<p><strong>接收字符串形式</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> defalut &#123;</span><br><span class="line">  <span class="attr">props</span>: [<span class="string">&quot;title&quot;</span>],</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params">props</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(props.<span class="property">title</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>接收对象形式</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">props</span>: &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">likes</span>: <span class="title class_">Number</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>自定义事件</strong></p>
<p>通过<code>emits:[]</code>自定义发射事件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">emits</span>: [<span class="string">&quot;custom&quot;</span>],</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params">props, ctx</span>) &#123;</span><br><span class="line">    ctx.<span class="title function_">emit</span>(<span class="string">&quot;custom&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div>

<h4 id="props-的校验"><a href="#props-的校验" class="headerlink" title="props 的校验"></a>props 的校验</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> props = <span class="title function_">defineProps</span>(&#123;</span><br><span class="line">  <span class="comment">// 基础类型检查</span></span><br><span class="line">  <span class="attr">propA</span>: <span class="title class_">Number</span>,</span><br><span class="line">  <span class="comment">// 多种可能的类型</span></span><br><span class="line">  <span class="attr">propB</span>: [<span class="title class_">String</span>, <span class="title class_">Number</span>],</span><br><span class="line">  <span class="comment">// 必传</span></span><br><span class="line">  <span class="attr">propC</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 默认值</span></span><br><span class="line">  <span class="attr">propD</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">Number</span>,</span><br><span class="line">    <span class="attr">default</span>: <span class="number">100</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 对象类型</span></span><br><span class="line">  <span class="attr">propE</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">Object</span>,</span><br><span class="line">    <span class="comment">// rawProps所有接收到的prop参数</span></span><br><span class="line">    <span class="title function_">default</span>(<span class="params">rawProps</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">message</span>: <span class="string">&quot;hello&quot;</span> &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 自定义类型函数</span></span><br><span class="line">  <span class="attr">propF</span>: &#123;</span><br><span class="line">    <span class="title function_">validator</span>(<span class="params">value</span>) &#123;</span><br><span class="line">      <span class="comment">// 传入的prop必须符合以下表达式</span></span><br><span class="line">      <span class="keyword">return</span> [<span class="string">&quot;success&quot;</span>, <span class="string">&quot;warning&quot;</span>, <span class="string">&quot;danger&quot;</span>].<span class="title function_">includes</span>(value);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="emit-传值校验"><a href="#emit-传值校验" class="headerlink" title="emit 传值校验"></a>emit 传值校验</h4><p>自定义事件传值也可以做校验</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> emit = <span class="title function_">defineEmits</span>(&#123;</span><br><span class="line">  <span class="title function_">submit</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="comment">// value验证是否通过</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Boolean</span>(value);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="modelValue的使用"><a href="#modelValue的使用" class="headerlink" title="modelValue的使用"></a><code>modelValue</code>的使用</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">&quot;searchText&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--等价于--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">:value</span>=<span class="string">&quot;searchText&quot;</span> @<span class="attr">input</span>=<span class="string">&quot;searchText = $event.target.value&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>在父组件中</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 等价于 在组件中这么使用 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">CustomInput</span> <span class="attr">:modelValue</span>=<span class="string">&quot;searchText&quot;</span></span></span><br><span class="line"><span class="tag">             @<span class="attr">update:modelValue</span>=<span class="string">&quot;newValue =&gt; searchText = newValue&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">CustomInput</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>以上为了子组件能正常运行，在<code>&lt;CustomInput /&gt;</code>中使用<code>definedProps</code>和<code>defineEmits</code>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">  <span class="title function_">defineProps</span>([<span class="string">&#x27;modelValue&#x27;</span>]) <span class="title function_">defineEmits</span>([<span class="string">&#x27;update:modelValue&#x27;</span>])</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:value</span>=<span class="string">&quot;modelValue&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">input</span>=<span class="string">&quot;$emit(&#x27;update:modelValue&#x27;, $event.target.value)&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="update：modelValue"><a href="#update：modelValue" class="headerlink" title="update：modelValue"></a>update：modelValue</h4><p>父组件提供的 prop 默认是<code>modelValue</code>形式</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">MyComponent</span> <span class="attr">:title</span>=<span class="string">&quot;bookTitle&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">MyComponent</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在子组件<code>&lt;MyComponent&gt;</code>中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;<span class="title function_">defineProps</span>([<span class="string">&#x27;title&#x27;</span>]) <span class="title function_">defineEmits</span>([<span class="string">&#x27;update:title&#x27;</span>])&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>多个 v-model 绑定</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">UserName</span> <span class="attr">v-model:first-name</span>=<span class="string">&quot;firstName&quot;</span> <span class="attr">v-model:last-name</span>=<span class="string">&quot;lastName&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="title function_">defineProps</span>(&#123;</span><br><span class="line">  <span class="attr">firstName</span>: <span class="title class_">String</span>,</span><br><span class="line">  <span class="attr">lastName</span>: <span class="title class_">String</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title function_">defineEmits</span>([<span class="string">&#x27;update:firstName&#x27;</span>, <span class="string">&#x27;update:lastName&#x27;</span>])</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="组件插槽"><a href="#组件插槽" class="headerlink" title="组件插槽"></a>组件插槽</h3><p><code>&lt;slot&gt;</code> 元素是一个<code>插槽的插口</code>，标示了父元素提供的<code>插槽内容</code>将在哪里被渲染。</p>
<div class="tabs" id=""><ul class="nav-tabs"><button type="button" class="tab  active" data-href="-1">渲染作用域</button><button type="button" class="tab " data-href="-2">默认内容</button><button type="button" class="tab " data-href="-3">具名插槽</button><button type="button" class="tab " data-href="-4">动态插槽名</button><button type="button" class="tab " data-href="-5">作用域插槽</button><button type="button" class="tab " data-href="-6">具名作用域插槽</button></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--父组件中--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">ChilComp</span>&gt;</span> &#123;&#123;message&#125;&#125; <span class="tag">&lt;/<span class="name">ChilComp</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>message</code>都是父组件中的渲染内容，内容一样。</p>
<p>但是插槽内容<code>无法访问子组件内容</code></p>
<ol>
<li>任何父组件模板中的东西都只被编译到父组件的作用域中；</li>
<li>而任何子组件模板中的东西都只被编译到子组件的作用域中。</li>
</ol></div><div class="tab-item-content" id="-2"><p><strong>默认内容</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">slot</span>&gt;</span></span><br><span class="line">    Submit</span><br><span class="line">    <span class="comment">&lt;!-- 默认内容 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="-3"><p>给<code>&lt;slot /&gt;</code>提供一个 name 属性，用来给各个插槽分配唯一的 ID</p>
<p><code>没有提供name属性的插槽隐式的命名为default</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&quot;header&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">main</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">footer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&quot;footer&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>父组件插入内容时，要提供一个<code>v-slot</code>的指令给<code>template</code>元素（<code>v-slot</code>的缩写是<code>#</code>）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">BaseLayout</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-slot:header</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- header 插槽的内容放这里 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">BaseLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="-4"><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">base-layout</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-slot:</span>[<span class="attr">dynamicSlotName</span>]&gt;</span> ... <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 缩写为 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> #[<span class="attr">dynamicSlotName</span>]&gt;</span> ... <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">base-layout</span>&gt;</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="-5"><p>有些场景需要在<code>插槽内使用父组件及子组件内的数据</code>，要做到这一点，可以通过<code>渲染插槽时将一部分数据提供给插槽</code>。</p>
<p>子组件<code>&lt;MyComponent&gt;</code>内：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- &lt;MyComponent&gt; 的模板 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">slot</span> <span class="attr">:text</span>=<span class="string">&quot;greetingMessage&quot;</span> <span class="attr">:count</span>=<span class="string">&quot;1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>当需要接收 prop 时，默认插槽和具名插槽使用方式有区别，父组件内的插槽接收 props：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">MyComponent</span> <span class="attr">v-slot</span>=<span class="string">&quot;slotProps&quot;</span>&gt;</span></span><br><span class="line">  &#123;&#123; slotProps.text &#125;&#125; &#123;&#123; slotProps.count &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">MyComponent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--也可以使用解构--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">MyComponent</span> <span class="attr">v-slot</span>=<span class="string">&quot;&#123;text, count&#125;&quot;</span>&gt;</span> &#123;&#123; text &#125;&#125; &#123;&#123; count &#125;&#125; <span class="tag">&lt;/<span class="name">MyComponent</span>&gt;</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="-6"><p><code>父组件访问不同的具名插槽的数据</code>，通过具名作用域插槽实现：</p>
<p>子组件中：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&quot;header&quot;</span> <span class="attr">message</span>=<span class="string">&quot;header&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">main</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">message</span>=<span class="string">&quot;默认值&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">footer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&quot;footer&quot;</span> <span class="attr">message</span>=<span class="string">&quot;footer&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>父组件中：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">MyComponent</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> #<span class="attr">header</span>=<span class="string">&quot;headerProps&quot;</span>&gt;</span> &#123;&#123; headerProps &#125;&#125; <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;defaultProps&quot;</span>&gt;</span> &#123;&#123; defaultProps &#125;&#125; <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> #<span class="attr">footer</span>=<span class="string">&quot;footerProps&quot;</span>&gt;</span> &#123;&#123; footerProps &#125;&#125; <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">MyComponent</span>&gt;</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div>

<h3 id="透传-Attribute"><a href="#透传-Attribute" class="headerlink" title="透传 Attribute"></a>透传 Attribute</h3><h4 id="属性继承"><a href="#属性继承" class="headerlink" title="属性继承"></a>属性继承</h4><p>父组件传递子组件的 props、或者事件是透传属性，但是像<code>class</code>、<code>style</code>、<code>id</code>这种属性没有显式的在子组件中声明，子组件也会继承来自父组件的属性：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--父组件中--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ChildComponent</span> <span class="attr">class</span>=<span class="string">&quot;large&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--子组件中--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;large&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>当子组件已经有<code>style</code>、<code>class</code>，属性会自动合并</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--父组件中--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ChildComponent</span> <span class="attr">class</span>=<span class="string">&quot;large&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color:red&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--子组件中--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;large selfClass&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color:red&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="事件继承"><a href="#事件继承" class="headerlink" title="事件继承"></a>事件继承</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--父组件中--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">MyButton</span> @<span class="attr">click</span>=<span class="string">&quot;onClick&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>监听器<code>click</code>会添加到<code>&lt;MyButton /&gt;</code>的根元素上，当根元素的事件触发后，也会触发父组件中的<code>onClick</code>方法。</p>
<p>如果子组件中同样有绑定事件，两个事件都会被触发。</p>
<h4 id="禁用-Attribute"><a href="#禁用-Attribute" class="headerlink" title="禁用 Attribute"></a>禁用 Attribute</h4><p>禁止属性的继承，在组件选项中设置:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"> <span class="keyword">export</span> <span class="keyword">default</span> &#123; <span class="attr">inheritAttrs</span>: <span class="literal">false</span> &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>若是使用<code>setup</code>语法糖，需要额外一个<code>script</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">inheritAttrs</span>: <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="comment">// ...setup 部分逻辑</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>最常见的需要禁用 attribute 继承的场景就是 attribute 需要应用在根节点以外的其他元素上，你可以完全控制透传进来的 attribute 如何应用。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>Fallthrough attribute: &#123;&#123; $attrs &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>几个注意点：</p>
<ol>
<li>像<code>foo-bar</code> 这样的属性，需要通过 <code>$attrs[&#39;foo-bar&#39;]</code> 来访问。</li>
<li>像 <code>@click</code> 这样事件监听器将在此对象下被暴露为一个函数 <code>$attrs.onClick</code>。</li>
</ol>
<p>举个例子：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;btn-wrapper&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn&quot;</span>&gt;</span>click me<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>假设父组件传递过来的 props 只应用到<code>button</code>上，而不是外层的<code>div</code>上</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;btn-wrapper&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn&quot;</span> <span class="attr">v-bind</span>=<span class="string">&quot;$attrs&quot;</span>&gt;</span>click me<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="多节点继承"><a href="#多节点继承" class="headerlink" title="多节点继承"></a>多节点继承</h4><p>有多个节点的子组件，没有自动属性的透传行为，如果<code>$attrs</code>没有被显示绑定，将会抛出警告。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">CustomLayout</span> <span class="attr">id</span>=<span class="string">&quot;custom-layout&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;changeValue&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>子组件内部是这样的：（因为不知道透传到哪一个节点）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">header</span>&gt;</span>...<span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">main</span>&gt;</span>...<span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">footer</span>&gt;</span>...<span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--如果有显式绑定，则不会有警告--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">header</span>&gt;</span>...<span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">main</span> <span class="attr">v-bind</span>=<span class="string">&quot;$attrs&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">footer</span>&gt;</span>...<span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="在-JS-中访问透传属性"><a href="#在-JS-中访问透传属性" class="headerlink" title="在 JS 中访问透传属性"></a>在 JS 中访问透传属性</h4><p>在<code>setup</code>语法糖中，可以使用<code>useAttrs()</code>来访问一个组件所有的透传属性：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;<span class="keyword">import</span> &#123;useAttrs&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span> <span class="keyword">const</span> attrs = <span class="title function_">useAttrs</span>()&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>不使用 setup&#96;语法糖中：将在上下文对象中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params">props, ctx</span>) &#123;</span><br><span class="line">    <span class="comment">// 透传 attribute 被暴露为 ctx.attrs</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(ctx.<span class="property">attrs</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>最为重要的一点！！！！ 透传的<code>attrs</code>，并不是响应式的。</p>
<ol>
<li>可以通过<code>props</code>来解决响应的问题</li>
<li>使用 <code>onUpdated()</code> 使得在每次更新时结合最新的 <code>attrs</code> 执行副作用。</li>
</ol>
<h3 id="动态组件"><a href="#动态组件" class="headerlink" title="动态组件"></a>动态组件</h3><p>当多个组件来回切换的时候，可以使用动态组件<code>&lt;component&gt;</code>的<code>is</code>属性实现：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;&#x27;tab&#x27; + currentTab&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>is</code>的值：</p>
<ol>
<li>被注册的组件名</li>
<li>导入的组件对象</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 假设现在有两个组件 分别是 tabLogin  tabRegister</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 当上面的例子currentTab 为 Login 时就会渲染 tabLogin组件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 相反，当currentTab 为 Register 时就会渲染 tabRegister组件</span></span><br></pre></td></tr></table></figure>

<p>组件切换后会自动卸载，可以通过<code>&lt;KeepAlive&gt;</code>组件强制不活跃的子组件仍然保持状态。</p>
<h3 id="全局注册组件"><a href="#全局注册组件" class="headerlink" title="全局注册组件"></a>全局注册组件</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line">app.<span class="title function_">component</span>(<span class="string">&quot;组件名&quot;</span>, 组件);</span><br></pre></td></tr></table></figure>

<p>链式全局注册：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app</span><br><span class="line">  .component(&#x27;ComponentA&#x27;, ComponentA)</span><br><span class="line">  .component(&#x27;ComponentB&#x27;, ComponentB)</span><br><span class="line">  .component(&#x27;ComponentC&#x27;, ComponentC)</span><br></pre></td></tr></table></figure>

<h3 id="局部注册组件"><a href="#局部注册组件" class="headerlink" title="局部注册组件"></a>局部注册组件</h3><p>若使用 setup 语法糖，导入的组件可以在本地直接使用，无需注册</p>
<p>若不使用 setup 语法糖，需要在<code>components</code>中注册</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">components</span>: &#123;</span><br><span class="line">    <span class="title class_">ComponentA</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="异步组件"><a href="#异步组件" class="headerlink" title="异步组件"></a>异步组件</h2><p>组件的按需引入，即<code>仅在需要时才从服务器加载相关组件</code>，使用<code>defineAsyncComponent()</code>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineAsyncComponent &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AsyncComp</span> = <span class="title function_">defineAsyncComponent</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="comment">/* 获取到的组件 */</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><code>defineAsyncComponent()</code>方法接收一个<code>返回Promise的加载函数</code>, <code>Promise</code>的<code>resolve</code>回调方法应该在服务器获得组件定义时调用，也可以用<code>reject()</code>表明加载失败。</p>
<h3 id="ES-模块动态导入"><a href="#ES-模块动态导入" class="headerlink" title="ES 模块动态导入"></a>ES 模块动态导入</h3><p>使用<code>ES模块动态导入</code>也会返回<code>Promise</code>，可以和<code>defineAsyncComponent()</code>联合使用：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">AsyncComp</span> = <span class="title function_">defineAsyncComponent</span>(<span class="function">() =&gt;</span></span><br><span class="line">  <span class="keyword">import</span>(<span class="string">&quot;./components/MyComponent.vue&quot;</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><code>AsyncComp</code>是一个包装器组件，仅在页面需要它时才调用加载函数，可以使用异步的包装器组件实现延迟加载。</p>
<h2 id="可复用性"><a href="#可复用性" class="headerlink" title="可复用性"></a>可复用性</h2><h3 id="组合式函数-Hook"><a href="#组合式函数-Hook" class="headerlink" title="组合式函数 Hook"></a>组合式函数 Hook</h3><p>封装公共任务的逻辑，使它变成一个可复用的函数，这个格式化封装了<code>无状态的逻辑</code>，它在接收到一些值后立刻返回所期望的输出。</p>
<p>其实就是 Hook 函数！</p>
<p>下面是简单的<code>鼠标位置的useMouse()</code>Hook:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// mouse.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref, onMounted, onUnmounted &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 按照惯例，组合式函数名以“use”开头</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useMouse</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 被组合式函数封装和管理的状态</span></span><br><span class="line">  <span class="keyword">const</span> x = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">const</span> y = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 组合式函数可以随时更改其状态。</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">update</span>(<span class="params">event</span>) &#123;</span><br><span class="line">    x.<span class="property">value</span> = event.<span class="property">pageX</span>;</span><br><span class="line">    y.<span class="property">value</span> = event.<span class="property">pageY</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 一个组合式函数也可以挂靠在所属组件的生命周期上</span></span><br><span class="line">  <span class="comment">// 来启动和卸载副作用</span></span><br><span class="line">  <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;mousemove&quot;</span>, update));</span><br><span class="line">  <span class="title function_">onUnmounted</span>(<span class="function">() =&gt;</span> <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&quot;mousemove&quot;</span>, update));</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 通过返回值暴露所管理的状态</span></span><br><span class="line">  <span class="keyword">return</span> &#123; x, y &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在组件使用的时候：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useMouse &#125; <span class="keyword">from</span> <span class="string">&quot;./mouse.js&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> &#123; x, y &#125; = <span class="title function_">useMouse</span>();</span><br></pre></td></tr></table></figure>

<h3 id="自定义指令"><a href="#自定义指令" class="headerlink" title="自定义指令"></a>自定义指令</h3><p>一个自定义指令被定义为一个包含类似于组件的生命周期钩子的对象。</p>
<p>在<code>setup</code>语法糖中，任何以<code>v</code>开头的驼峰命名都可以被用作一个自定义指令。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="comment">// 在模板中启用 v-focus</span></span><br><span class="line"><span class="keyword">const</span> vFocus = &#123;</span><br><span class="line">  <span class="attr">mounted</span>: <span class="function">(<span class="params">el</span>) =&gt;</span> el.<span class="title function_">focus</span>()</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-focus</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>上面自动聚焦指令：可以在页面完成加载后运行，也可以在 Vue 动态插入元素后运行</p>
<p><strong>全局注册指令：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(&#123;&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">directive</span>(<span class="string">&quot;focus&quot;</span>, &#123;&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>指令钩子：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myDirective = &#123;</span><br><span class="line">  <span class="comment">// 在绑定元素的 attribute 前</span></span><br><span class="line">  <span class="comment">// 或事件监听器应用前调用</span></span><br><span class="line">  <span class="title function_">created</span>(<span class="params">el, binding, vnode, prevVnode</span>) &#123;</span><br><span class="line">    <span class="comment">// 下面会介绍各个参数的细节</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 在元素被插入到 DOM 前调用</span></span><br><span class="line">  <span class="title function_">beforeMount</span>(<span class="params"></span>) &#123;&#125;,</span><br><span class="line">  <span class="comment">// 在绑定元素的父组件</span></span><br><span class="line">  <span class="comment">// 及他自己的所有子节点都挂载完成后调用</span></span><br><span class="line">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;&#125;,</span><br><span class="line">  <span class="comment">// 绑定元素的父组件更新前调用</span></span><br><span class="line">  <span class="title function_">beforeUpdate</span>(<span class="params"></span>) &#123;&#125;,</span><br><span class="line">  <span class="comment">// 在绑定元素的父组件</span></span><br><span class="line">  <span class="comment">// 及他自己的所有子节点都更新后调用</span></span><br><span class="line">  <span class="title function_">updated</span>(<span class="params"></span>) &#123;&#125;,</span><br><span class="line">  <span class="comment">// 绑定元素的父组件卸载前调用</span></span><br><span class="line">  <span class="title function_">beforeUnmount</span>(<span class="params"></span>) &#123;&#125;,</span><br><span class="line">  <span class="comment">// 绑定元素的父组件卸载后调用</span></span><br><span class="line">  <span class="title function_">unmounted</span>(<span class="params"></span>) &#123;&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>钩子参数：</strong></p>
<ol>
<li><code>el</code>: 指令绑定到元素，可以直接操作 DOM</li>
<li><code>binding</code>: 一个对象，包含<ol>
<li><code>value</code>：传递给指令的值，例如在<code>v-my-directive=&quot;1 + 1&quot;</code>中，值是 2</li>
<li><code>oldValue</code>：旧值，仅在<code>beforeUpdate</code>和<code>updated</code>中可用</li>
<li><code>arg</code>：传给指令的参数，<code>v-my-directive:foo</code>中，参数是<code>&quot;foo&quot;</code></li>
<li><code>modifiers</code>：一个包含修饰符的对象，<code>v-my-direactive.foo.bar</code>中，修饰符对象是<code>&#123;foo: true, bar: true&#125;</code></li>
<li><code>instance</code>：使用该指令的组件实例</li>
<li><code>dir</code>：指令的定义对象</li>
</ol>
</li>
<li><code>vnode</code>：代表绑定元素的底层 VNode</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-example:foo.bar</span>=<span class="string">&quot;baz&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>binding</code>参数会是这样一个对象：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">arg</span>: <span class="string">&#x27;foo&#x27;</span>,</span><br><span class="line">  <span class="attr">modifiers</span>: &#123;<span class="attr">bar</span>: <span class="literal">true</span>&#125;,</span><br><span class="line">  <span class="attr">value</span>: <span class="comment">/* `baz` 的值 */</span>,</span><br><span class="line">  <span class="attr">oldValue</span>: <span class="comment">/* 上一次更新时 `baz` 的值 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>简化形式：</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-color</span>=<span class="string">&quot;color&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">directive</span>(<span class="string">&quot;color&quot;</span>, <span class="function">(<span class="params">el, binding</span>) =&gt;</span> &#123;</span><br><span class="line">  el.<span class="property">style</span>.<span class="property">color</span> = binding.<span class="property">value</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>对象字面量</strong></p>
<p>如果指令需要多个值，可以向它传递一个 JavaScript 对象字面量，也可以接收表达式</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-demo</span>=<span class="string">&quot;&#123; color: &#x27;white&#x27;, text: &#x27;hello!&#x27; &#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">directive</span>(<span class="string">&quot;demo&quot;</span>, <span class="function">(<span class="params">el, binding</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(binding.<span class="property">value</span>.<span class="property">color</span>); <span class="comment">// =&gt; &quot;white&quot;</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(binding.<span class="property">value</span>.<span class="property">text</span>); <span class="comment">// =&gt; &quot;hello!&quot;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h3><p>插件是一种能为 Vue 添加全局功能的工具代码，安装一个插件：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(&#123;&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(myPlugin, &#123;</span><br><span class="line">  <span class="comment">/* 可选的选项 */</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>插件是拥有<code>install()</code>方法的对象，是一个安装函数，函数接收<code>应用实例</code>和<code>app.use()</code>的额外选项：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myPlugin = &#123;</span><br><span class="line">  <span class="title function_">install</span>(<span class="params">app, options</span>) &#123;&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>使用场景：</p>
<ol>
<li>通过<code>app.component()</code>和<code>app.directive()</code>注册的组件和指令</li>
<li>通过<code>app.provide()</code>使一个资源可供给全局</li>
<li>向<code>app.config.globalProperties</code>中添加一些全局实例属性和方法</li>
</ol>
<div class="tabs" id=""><ul class="nav-tabs"><button type="button" class="tab  active" data-href="-1">编写插件</button><button type="button" class="tab " data-href="-2">插件中的Provide和Inject</button></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><p><code>i18n</code>国际化插件</p>
<p>在一个单独的文件创建并导出它</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">install</span>(<span class="params">app, options</span>) &#123;&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>在<code>app.config.globalProperties</code>上，编写一个翻译文本的函数，函数接收一个值，在字段中查找对应的值得到翻译内容</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">install</span>(<span class="params">app, options</span>) &#123;</span><br><span class="line">    <span class="comment">// 注入一个全局可用的 $translate() 方法</span></span><br><span class="line">    app.<span class="property">config</span>.<span class="property">globalProperties</span>.<span class="property">$translate</span> = <span class="function">(<span class="params">key</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 获取 `options` 对象的深层属性</span></span><br><span class="line">      <span class="comment">// 使用 `key` 作为索引</span></span><br><span class="line">      <span class="keyword">return</span> key.<span class="title function_">split</span>(<span class="string">&quot;.&quot;</span>).<span class="title function_">reduce</span>(<span class="function">(<span class="params">o, i</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (o) <span class="keyword">return</span> o[i];</span><br><span class="line">      &#125;, options);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>这个插件希望用户在使用该插件时，通过传入一个对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> i18nPlugin <span class="keyword">from</span> <span class="string">&quot;./plugins/i18n&quot;</span>;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(i18nPlugin, &#123;</span><br><span class="line">  <span class="attr">greetings</span>: &#123;</span><br><span class="line">    <span class="attr">hello</span>: <span class="string">&quot;Bonjour!&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><code>$translate</code>会接收一个<code>greetins.hello</code>的字符串，在用户提供的字典中查找，并返回翻译的值</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123; $translate(&#x27;greetings.hello&#x27;) &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="-2"><p>在插件中，可以通过<code>Provide</code>来为插件用户提供一些内容，我们可以将<code>options</code>参数提供给整个应用，以便整个组件都可以使用翻译字典对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// plugins/i18n.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">install</span>: <span class="function">(<span class="params">app, options</span>) =&gt;</span> &#123;</span><br><span class="line">    app.<span class="property">config</span>.<span class="property">globalProperties</span>.<span class="property">$translate</span> = <span class="function">(<span class="params">key</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> key.<span class="title function_">split</span>(<span class="string">&quot;.&quot;</span>).<span class="title function_">reduce</span>(<span class="function">(<span class="params">o, i</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (o) <span class="keyword">return</span> o[i];</span><br><span class="line">      &#125;, options);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    app.<span class="title function_">provide</span>(<span class="string">&quot;i18n&quot;</span>, options);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>插件用户就可以在他们的组件中以 <code>i18n</code> 为 key 注入并访问插件的选项对象了</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">  <span class="keyword">import</span> &#123;inject&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span> <span class="keyword">const</span> i18n = <span class="title function_">inject</span>(<span class="string">&#x27;i18n&#x27;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(i18n.<span class="property">greetings</span>.<span class="property">hello</span>)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div>
</article><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/02/10/vue%E6%96%87%E4%BB%B6%E8%B7%AF%E7%94%B1%E7%94%9F%E6%88%90/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/default_cover.jpg&quot;" data-lazy-src="https://s2.loli.net/2022/02/02/QxIWdTG2rFOaRSv.png" onerror="onerror=null;src='/img/default_cover.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">vue文件路由生成</div></div></a></div><div class="next-post pull-right"><a href="/2022/05/28/Node/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/default_cover.jpg&quot;" data-lazy-src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fpic1.zhimg.com%2Fv2-f6241353ba024915b991e8d5847b8da2_1440w.jpg%3Fsource%3D172ae18b&amp;refer=http%3A%2F%2Fpic1.zhimg.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto?sec=1659410579&amp;t=a3fd1f73c15a8fe0f9b98e0520731d31" onerror="onerror=null;src='/img/default_cover.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Nodejs</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/default_cover.jpg&quot;" data-lazy-src="/img/baby.png" onerror="this.onerror=null;this.src='/img/404.gif'" alt="avatar"/></div><div class="author-info__description"></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">知瑾</h1><div class="author-info__desc">生活明朗 万物可爱</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/berniezwd" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E-Vue3"><span class="toc-number">1.</span> <span class="toc-text">关于 Vue3</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue%E4%B8%A4%E4%B8%AA%E6%A0%B8%E5%BF%83"><span class="toc-number">1.1.</span> <span class="toc-text">Vue两个核心?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E6%96%87%E4%BB%B6%E7%BB%84%E4%BB%B6%EF%BC%9F"><span class="toc-number">1.2.</span> <span class="toc-text">单文件组件？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%89%E9%A1%B9%E5%BC%8F%E5%92%8C%E7%BB%84%E5%90%88%E5%BC%8F%E7%9A%84%E7%89%B9%E7%82%B9%EF%BC%9F"><span class="toc-number">1.3.</span> <span class="toc-text">选项式和组合式的特点？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vite-%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE%E5%91%BD%E4%BB%A4%EF%BC%9A"><span class="toc-number">1.4.</span> <span class="toc-text">vite 创建项目命令：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#vite-%E4%B8%AD%E4%BD%BF%E7%94%A8-less"><span class="toc-number">1.4.1.</span> <span class="toc-text">vite 中使用 less</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA-vue-%E5%BA%94%E7%94%A8%EF%BC%9A"><span class="toc-number">1.5.</span> <span class="toc-text">创建 vue 应用：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B"><span class="toc-number">1.5.1.</span> <span class="toc-text">应用实例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%82%E8%BD%BD%E5%BA%94%E7%94%A8"><span class="toc-number">1.5.2.</span> <span class="toc-text">挂载应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E9%85%8D%E7%BD%AE"><span class="toc-number">1.5.3.</span> <span class="toc-text">应用配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%82%E8%BD%BD%E5%A4%9A%E4%B8%AA%E5%BA%94%E7%94%A8"><span class="toc-number">1.5.4.</span> <span class="toc-text">挂载多个应用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E5%BC%8F%E5%9F%BA%E7%A1%80"><span class="toc-number">2.</span> <span class="toc-text">响应式基础:</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E%E5%93%8D%E5%BA%94%E5%BC%8F%E7%8A%B6%E6%80%81"><span class="toc-number">2.0.1.</span> <span class="toc-text">声明响应式状态</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DOM-%E6%9B%B4%E6%96%B0%E6%97%B6%E6%9C%BA"><span class="toc-number">2.0.2.</span> <span class="toc-text">DOM 更新时机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%B1%E5%B1%82%E5%93%8D%E5%BA%94%E6%80%A7"><span class="toc-number">2.0.3.</span> <span class="toc-text">深层响应性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E5%BC%8F%E4%BB%A3%E7%90%86-vs-%E5%8E%9F%E5%A7%8B%E5%AF%B9%E8%B1%A1"><span class="toc-number">2.0.4.</span> <span class="toc-text">响应式代理 vs 原始对象</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7"><span class="toc-number">3.</span> <span class="toc-text">计算属性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8%EF%BC%9A"><span class="toc-number">3.0.0.1.</span> <span class="toc-text">基础使用：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%AF%E4%BF%AE%E6%94%B9%E7%9A%84%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7"><span class="toc-number">3.0.0.2.</span> <span class="toc-text">可修改的计算属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7%E7%BC%93%E5%AD%98-vs-%E6%96%B9%E6%B3%95"><span class="toc-number">3.0.0.3.</span> <span class="toc-text">计算属性缓存 vs 方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7%E4%BD%BF%E7%94%A8%E6%B3%A8%E6%84%8F%E7%82%B9%EF%BC%9A"><span class="toc-number">3.0.0.4.</span> <span class="toc-text">计算属性使用注意点：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%A6%E5%90%AC%E5%99%A8"><span class="toc-number">3.1.</span> <span class="toc-text">侦听器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E4%BE%A6%E5%90%AC"><span class="toc-number">3.1.1.</span> <span class="toc-text">基础侦听</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%B1%E5%B1%82%E4%BE%A6%E5%90%AC"><span class="toc-number">3.1.2.</span> <span class="toc-text">深层侦听</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#watchEffect"><span class="toc-number">3.1.3.</span> <span class="toc-text">watchEffect</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9E%E8%B0%83%E7%9A%84%E5%88%B7%E6%96%B0%E6%97%B6%E6%9C%BA"><span class="toc-number">3.1.4.</span> <span class="toc-text">回调的刷新时机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%96%E6%B6%88%E7%9B%91%E5%90%AC"><span class="toc-number">3.1.5.</span> <span class="toc-text">取消监听</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E4%B8%8E%E6%A0%B7%E5%BC%8F%E7%9A%84%E7%BB%91%E5%AE%9A"><span class="toc-number">3.2.</span> <span class="toc-text">类与样式的绑定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E6%B8%B2%E6%9F%93"><span class="toc-number">3.3.</span> <span class="toc-text">条件渲染</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%97%E8%A1%A8%E6%B8%B2%E6%9F%93"><span class="toc-number">3.4.</span> <span class="toc-text">列表渲染</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A"><span class="toc-number">3.5.</span> <span class="toc-text">事件绑定</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E4%BF%AE%E9%A5%B0%E7%AC%A6%EF%BC%9A"><span class="toc-number">3.5.1.</span> <span class="toc-text">基础修饰符：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%89%E9%94%AE%E4%BF%AE%E9%A5%B0%E7%AC%A6%EF%BC%9A"><span class="toc-number">3.5.2.</span> <span class="toc-text">按键修饰符：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">3.6.</span> <span class="toc-text">生命周期</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5"><span class="toc-number">3.7.</span> <span class="toc-text">依赖注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E7%BD%AE%E7%BB%84%E4%BB%B6"><span class="toc-number">3.8.</span> <span class="toc-text">内置组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Transtion"><span class="toc-number">3.8.1.</span> <span class="toc-text">Transtion</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BA%E8%BF%87%E6%B8%A1%E5%91%BD%E5%90%8D"><span class="toc-number">3.8.1.1.</span> <span class="toc-text">为过渡命名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BF%87%E6%B8%A1-class"><span class="toc-number">3.8.1.2.</span> <span class="toc-text">自定义过渡 class</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BA%E7%8E%B0%E6%97%B6%E8%BF%87%E6%B8%A1"><span class="toc-number">3.8.1.3.</span> <span class="toc-text">出现时过渡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E9%97%B4%E8%BF%87%E6%B8%A1"><span class="toc-number">3.8.1.4.</span> <span class="toc-text">组件间过渡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%91%E5%90%AC%E8%BF%87%E6%B8%A1%E4%BA%8B%E4%BB%B6"><span class="toc-number">3.8.1.5.</span> <span class="toc-text">监听过渡事件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#TransitionGroup"><span class="toc-number">3.8.1.6.</span> <span class="toc-text">TransitionGroup</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#KeepAlive"><span class="toc-number">3.8.2.</span> <span class="toc-text">KeepAlive</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Teleport"><span class="toc-number">3.8.3.</span> <span class="toc-text">Teleport</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Suspense"><span class="toc-number">3.8.4.</span> <span class="toc-text">Suspense</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#async-setup%EF%BC%88%EF%BC%89"><span class="toc-number">3.8.4.1.</span> <span class="toc-text">async setup（）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD%E4%B8%AD%E7%8A%B6%E6%80%81"><span class="toc-number">3.8.4.2.</span> <span class="toc-text">加载中状态</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E7%BD%AE%E7%BB%84%E4%BB%B6%E7%BB%93%E5%90%88%E4%BD%BF%E7%94%A8%EF%BC%9A"><span class="toc-number">3.8.5.</span> <span class="toc-text">内置组件结合使用：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF-ref"><span class="toc-number">3.9.</span> <span class="toc-text">模板 ref</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E5%9F%BA%E7%A1%80"><span class="toc-number">3.10.</span> <span class="toc-text">组件基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E5%AE%9A%E4%B9%89"><span class="toc-number">3.10.1.</span> <span class="toc-text">组件定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E4%BC%A0%E5%80%BC"><span class="toc-number">3.10.2.</span> <span class="toc-text">组件传值</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#props-%E7%9A%84%E6%A0%A1%E9%AA%8C"><span class="toc-number">3.10.2.1.</span> <span class="toc-text">props 的校验</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#emit-%E4%BC%A0%E5%80%BC%E6%A0%A1%E9%AA%8C"><span class="toc-number">3.10.2.2.</span> <span class="toc-text">emit 传值校验</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#modelValue%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">3.10.2.3.</span> <span class="toc-text">modelValue的使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#update%EF%BC%9AmodelValue"><span class="toc-number">3.10.2.4.</span> <span class="toc-text">update：modelValue</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E6%8F%92%E6%A7%BD"><span class="toc-number">3.10.3.</span> <span class="toc-text">组件插槽</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%8F%E4%BC%A0-Attribute"><span class="toc-number">3.10.4.</span> <span class="toc-text">透传 Attribute</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E7%BB%A7%E6%89%BF"><span class="toc-number">3.10.4.1.</span> <span class="toc-text">属性继承</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E7%BB%A7%E6%89%BF"><span class="toc-number">3.10.4.2.</span> <span class="toc-text">事件继承</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A6%81%E7%94%A8-Attribute"><span class="toc-number">3.10.4.3.</span> <span class="toc-text">禁用 Attribute</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E8%8A%82%E7%82%B9%E7%BB%A7%E6%89%BF"><span class="toc-number">3.10.4.4.</span> <span class="toc-text">多节点继承</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8-JS-%E4%B8%AD%E8%AE%BF%E9%97%AE%E9%80%8F%E4%BC%A0%E5%B1%9E%E6%80%A7"><span class="toc-number">3.10.4.5.</span> <span class="toc-text">在 JS 中访问透传属性</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E7%BB%84%E4%BB%B6"><span class="toc-number">3.10.5.</span> <span class="toc-text">动态组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E6%B3%A8%E5%86%8C%E7%BB%84%E4%BB%B6"><span class="toc-number">3.10.6.</span> <span class="toc-text">全局注册组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%80%E9%83%A8%E6%B3%A8%E5%86%8C%E7%BB%84%E4%BB%B6"><span class="toc-number">3.10.7.</span> <span class="toc-text">局部注册组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%82%E6%AD%A5%E7%BB%84%E4%BB%B6"><span class="toc-number">3.11.</span> <span class="toc-text">异步组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ES-%E6%A8%A1%E5%9D%97%E5%8A%A8%E6%80%81%E5%AF%BC%E5%85%A5"><span class="toc-number">3.11.1.</span> <span class="toc-text">ES 模块动态导入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%AF%E5%A4%8D%E7%94%A8%E6%80%A7"><span class="toc-number">3.12.</span> <span class="toc-text">可复用性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E5%BC%8F%E5%87%BD%E6%95%B0-Hook"><span class="toc-number">3.12.1.</span> <span class="toc-text">组合式函数 Hook</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4"><span class="toc-number">3.12.2.</span> <span class="toc-text">自定义指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E4%BB%B6"><span class="toc-number">3.12.3.</span> <span class="toc-text">插件</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/07/13/%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8/" title="云服务器相关"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/default_cover.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/berniezhong/picture-bed/github/202407131709165.png" onerror="this.onerror=null;this.src='/img/default_cover.jpg'" alt="云服务器相关"/></a><div class="content"><a class="title" href="/2024/07/13/%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8/" title="云服务器相关">云服务器相关</a><time datetime="2024-07-12T16:00:00.000Z" title="发表于 2024-07-13 00:00:00">2024-07-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/13/Docker%E5%AE%89%E8%A3%85%E4%B8%8E%E9%95%9C%E5%83%8F%E6%BA%90%E9%97%AE%E9%A2%98/" title="Docker安装与镜像源问题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/default_cover.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/berniezhong/picture-bed/github/202407131500894.png" onerror="this.onerror=null;this.src='/img/default_cover.jpg'" alt="Docker安装与镜像源问题"/></a><div class="content"><a class="title" href="/2024/07/13/Docker%E5%AE%89%E8%A3%85%E4%B8%8E%E9%95%9C%E5%83%8F%E6%BA%90%E9%97%AE%E9%A2%98/" title="Docker安装与镜像源问题">Docker安装与镜像源问题</a><time datetime="2024-07-12T16:00:00.000Z" title="发表于 2024-07-13 00:00:00">2024-07-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/13/Docker%E4%B8%80%E4%BA%9B%E6%A6%82%E5%BF%B5/" title="Docker认识"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/default_cover.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/berniezhong/picture-bed/github/202407131500894.png" onerror="this.onerror=null;this.src='/img/default_cover.jpg'" alt="Docker认识"/></a><div class="content"><a class="title" href="/2024/07/13/Docker%E4%B8%80%E4%BA%9B%E6%A6%82%E5%BF%B5/" title="Docker认识">Docker认识</a><time datetime="2024-07-12T16:00:00.000Z" title="发表于 2024-07-13 00:00:00">2024-07-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/13/Docker%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4/" title="Docker操作命令"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/default_cover.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/berniezhong/picture-bed/github/202407131500894.png" onerror="this.onerror=null;this.src='/img/default_cover.jpg'" alt="Docker操作命令"/></a><div class="content"><a class="title" href="/2024/07/13/Docker%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4/" title="Docker操作命令">Docker操作命令</a><time datetime="2024-07-12T16:00:00.000Z" title="发表于 2024-07-13 00:00:00">2024-07-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/14/%E8%B5%84%E6%BA%90%E9%9B%86%E5%90%88/" title="工具箱"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/default_cover.jpg&quot;" data-lazy-src="/img/default_cover.jpg" onerror="this.onerror=null;this.src='/img/default_cover.jpg'" alt="工具箱"/></a><div class="content"><a class="title" href="/2024/06/14/%E8%B5%84%E6%BA%90%E9%9B%86%E5%90%88/" title="工具箱">工具箱</a><time datetime="2024-06-13T16:00:00.000Z" title="发表于 2024-06-14 00:00:00">2024-06-14</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2024 By 知瑾</div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">41</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">33</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">31</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">React</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://berniezwd.github.io/REACT_MARQUEE/" title="跑马灯"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/default_cover.jpg&quot;" data-lazy-src="/img/project/marquee.png" alt="跑马灯"/><span class="back-menu-item-text">跑马灯</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">有趣</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://berniezwd.github.io/PeopleJS/" title="人潮汹涌"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/default_cover.jpg&quot;" data-lazy-src="/img/project/people.png" alt="人潮汹涌"/><span class="back-menu-item-text">人潮汹涌</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 即刻短文</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Docker/" style="font-size: 0.88rem;">Docker<sup>3</sup></a><a href="/tags/Html/" style="font-size: 0.88rem;">Html<sup>1</sup></a><a href="/tags/JavaScript/" style="font-size: 0.88rem;">JavaScript<sup>3</sup></a><a href="/tags/Jenkins%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/" style="font-size: 0.88rem;">Jenkins自动化部署<sup>1</sup></a><a href="/tags/Nginx/" style="font-size: 0.88rem;">Nginx<sup>1</sup></a><a href="/tags/Pinia/" style="font-size: 0.88rem;">Pinia<sup>1</sup></a><a href="/tags/React/" style="font-size: 0.88rem;">React<sup>4</sup></a><a href="/tags/Redux/" style="font-size: 0.88rem;">Redux<sup>1</sup></a><a href="/tags/TypeScript/" style="font-size: 0.88rem;">TypeScript<sup>1</sup></a><a href="/tags/Vue/" style="font-size: 0.88rem;">Vue<sup>2</sup></a><a href="/tags/axios/" style="font-size: 0.88rem;">axios<sup>1</sup></a><a href="/tags/centOS/" style="font-size: 0.88rem;">centOS<sup>1</sup></a><a href="/tags/css/" style="font-size: 0.88rem;">css<sup>2</sup></a><a href="/tags/electron/" style="font-size: 0.88rem;">electron<sup>2</sup></a><a href="/tags/koa/" style="font-size: 0.88rem;">koa<sup>1</sup></a><a href="/tags/mysql/" style="font-size: 0.88rem;">mysql<sup>1</sup></a><a href="/tags/nestjs/" style="font-size: 0.88rem;">nestjs<sup>1</sup></a><a href="/tags/node/" style="font-size: 0.88rem;">node<sup>1</sup></a><a href="/tags/sass/" style="font-size: 0.88rem;">sass<sup>1</sup></a><a href="/tags/uniapp/" style="font-size: 0.88rem;">uniapp<sup>1</sup></a><a href="/tags/vim/" style="font-size: 0.88rem;">vim<sup>1</sup></a><a href="/tags/vite/" style="font-size: 0.88rem;">vite<sup>1</sup></a><a href="/tags/vue/" style="font-size: 0.88rem;">vue<sup>1</sup></a><a href="/tags/vue3/" style="font-size: 0.88rem;">vue3<sup>1</sup></a><a href="/tags/%E4%BA%91%E6%9C%8D%E5%8A%A1/" style="font-size: 0.88rem;">云服务<sup>1</sup></a><a href="/tags/%E5%8F%B3%E9%94%AEcmd/" style="font-size: 0.88rem;">右键cmd<sup>1</sup></a><a href="/tags/%E5%B7%A5%E5%85%B7%E7%B1%BB/" style="font-size: 0.88rem;">工具类<sup>1</sup></a><a href="/tags/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" style="font-size: 0.88rem;">开发环境搭建<sup>1</sup></a><a href="/tags/%E6%96%87%E4%BB%B6%E8%B7%AF%E7%94%B1/" style="font-size: 0.88rem;">文件路由<sup>1</sup></a><a href="/tags/%E6%A0%87%E7%AD%BE%E5%A4%96%E6%8C%82/" style="font-size: 0.88rem;">标签外挂<sup>1</sup></a><a href="/tags/%E9%9B%B6%E6%95%A3/" style="font-size: 0.88rem;">零散<sup>1</sup></a><a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 0.88rem;">面试<sup>1</sup></a><a href="/tags/%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA%E8%A7%84%E8%8C%83/" style="font-size: 0.88rem;">项目搭建规范<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><a id="switch-commentBarrage" href="javascript:anzhiyu.switchCommentBarrage();" title="开关弹幕"><i class="anzhiyufont anzhiyu-icon-danmu"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.cbd.int/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://cdn.cbd.int/mermaid@10.2.4/dist/mermaid.min.js').then(runMermaid)
  }

  anzhiyu.addGlobalFn('themeChange', runMermaid, 'mermaid')

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const initValine = () => {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'Rx9TnE1k1TFznGsBX5hvBTg2-gzGzoHsz',
      appKey: 'ReVHDww8qvNFAR7CALtta8S5',
      avatar: 'mp',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  const loadValine = async () => {
    if (typeof Valine === 'function') initValine()
    else {
      await getScript('https://cdn.cbd.int/valine@1.5.1/dist/Valine.min.js')
      initValine()
    }
  }

  if ('Valine' === 'Valine' || !true) {
    if (true) anzhiyu.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script src="https://cdn.cbd.int/blueimp-md5@2.19.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getIcon = (icon, mail) => {
    if (icon) return icon
    let defaultIcon = '?d=mp'
    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`
    return iconUrl
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }

        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const getComment = () => {
    const serverURL = 'https://Rx9TnE1k.api.lncldglobal.com'

    var settings = {
      "method": "GET",
      "headers": {
        "X-LC-Id": 'Rx9TnE1k1TFznGsBX5hvBTg2-gzGzoHsz',
        "X-LC-Key": 'ReVHDww8qvNFAR7CALtta8S5',
        "Content-Type": "application/json"
      },
    }

    fetch(`${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,settings)
      .then(response => response.json())
      .then(data => {
        const valineArray = data.results.map(function (e) {
          return {
            'avatar': getIcon(e.QQAvatar, e.mail),
            'content': changeContent(e.comment),
            'nick': e.nick,
            'url': e.url + '#' + e.objectId,
            'date': e.updatedAt,
          }
        })
        saveToLocal.set('valine-newest-comments', JSON.stringify(valineArray), 10/(60*24))
        generateHtml(valineArray)
      }).catch(e => {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      }) 
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('valine-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>